<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251"> 
<TITLE>Заголовок</TITLE>
<LINK rel="stylesheet" type="text/css" href="base.css">
</HEAD>
<BODY>
<A name="start"></A>
<H1>Обмен бухгалтерскими документами между БД семейства АКЦЕНТ версии 6.0.</H1>
<P align=left>15 декабря 2001 г.</P>
<P align=left>Настройка "Обмен данными..." является правопреемницей, 
наследницей, логическим продолжением настройки "Экспорт/импорт 
данных...".</P>
<P align=left>Ключевой особенностью данной настройки является 
иднтификация объектов баз данных по GIUD'ам (глобальным 
идентификаторам).GUID, представляющий собой 128-битную строку 
и являющийся уникальным идентификатором любого объекта, присваивается 
объекту базы данных при его создани и однозначно идентифицирует 
его на протяжнии "жизни" объекта.</P>
<P align=left>Это свойство уникальности GUID'а и используется для
идентификации объектов баз данных при обмене бухгалтерскими 
документами.</P>

<h2>Состав настройки.</h2>
<P align=left>В настройку "Обмен документами" входят следующие файлы</P>
<TT>Projects\DocsExchange.acp (DocsExchangeT.acp</TT> - для варианта с 
шаблонами) - скомпилированный файл проекта для <i>Акцент 6.0</i><BR>
<TT>Docs\DocsExchange\whatnews.txt</TT> - что нового<BR>
<TT>Docs\DocsExchange\DocsExchangeUser.htm</TT> - настоящая документация<BR>

<h2>Установка и подключение.</h2>
<P align=left>Установка настройки осуществляется запуском файла 
<TT>DocsExchange.msi</TT> (или <TT>DocsExchangeT.msi</TT>) в каталог, 
где установлен <i>Акцент 6.0</i>.
Если исполняемый модуль программы <i>Акцент 6.0</i> <TT>accent6.exe</TT> или 
<TT>accent6s.exe</TT> находится в каталоге <TT>C:\Program Files\Accent 6.0\Programs</TT>,
то установку следует выполнять в каталог <TT>C:\Program Files\Accent 6.0</TT>.
</P>
<P align=left>После установки настройки "Обмен документами" в программе <i>Акцент 6.0</i>
необходимо указать расположение скомпилированных файлов проектов <TT>ACP</TT>. Для этого 
в главном окне программы необходимо выбрать пункт меню "Сервис" подменю "Настройка". 
В окне, расположенном в левой части окна диалога, выбрать "Расположение файлов".
В правой части окна диалога в текстовом редакторе будет отображена информация о том, 
где программа <i>Акцент 6.0</i> будет искать дополнительные формы, модули, проекты и прочее.
Для того чтобы файл проекта был обнаружен, должна быть определена строка или строки примерно 
следующего содержания :</P>
<tt>*.ACP =    #Data\..\Projects<BR>
*.ACP = #App\..\Projects<BR>
*.ACP = C:\Program Files\Accent 6.0\Projects<BR></tt>
<P align=left>Процесс обмена данными между базами данных состоит из процессов 
экспортирования информации из базы-источника в промежуточный файл и импортирования 
данной информации в базу-приемник. Кроме того существует возможность экспорта 
различных справочников в промежуточный файл для последующего импортирования данных 
справочников в базу-приемник.
</P>
<P align=left>Процесс экспортирования бухгалтерских документов из базы-источника 
выполняется с помощью диалога <tt>exp_main.adg</tt>.</P>
<P align=left>Процесс экспорта справочной информации осуществляется при помощи 
диалога <tt>exp_handbooks.adg</tt>.</P>
<P align=left>Процесс импорта данных в базу-приемник производиться при помощи 
диалога <tt>imp_main.adg</tt>.</P>
<P align=left>Вызов данных диалогов из файла проекта осуществляется при помощи 
следующего синтаксиса:</P>
<tt>
DocsExchange.acp#exp_main.adg<br>
DocsExchange.acp#exp_handbooks.adg<br>
DocsExchange.acp#imp_main.adg<br>
</tt>
или 
<tt>
DocsExchangeT.acp#exp_main.adg<br>
DocsExchangeT.acp#exp_handbooks.adg<br>
DocsExchangeT.acp#imp_main.adg<br>
</tt>
<P align=left>То есть вначале указывается имя файла проекта, далее символ '#', 
а затем - имя необходимого диалога. В общем случае вызов данных диалогов может 
осуществляться из любого места программы, но, на наш взгляд, наиболее удобным 
местом для вызова данных диалогов является пункт меню «Действие». 
</P>
<P align=left>Для редактирования меню «Действие» необходимо вызвать окно «Проект». 
Для этого в главном окне программы Акцент 6.0 выберите пункт меню «Сервис» подменю 
«Конструктор» или нажмите Alt+F11.
</P>
<P align=left>В окне проекта выберите меню «Сервис» подменю «Меню «Действия»».
При помощи команды "Добавить" следует внести новые команды для запуска 
необходимых диалогов по описанному выше синтаксису. Например:
</P>
<P align=left>
Команда меню - "Экспорт", файл - <tt>DocsExchange.acp#exp_main.adg</tt><br>
Команда меню - "Импорт", файл - <tt>DocsExchange.acp#imp_main.adg</tt><br>
Команда меню - "Экспорт справочников", файл - <tt>DocsExchange.acp#exp_handbooks.adg</tt><br>
или
Команда меню - "Экспорт", файл - <tt>DocsExchangeT.acp#exp_main.adg</tt><br>
Команда меню - "Импорт", файл - <tt>DocsExchangeT.acp#imp_main.adg</tt><br>
Команда меню - "Экспорт справочников", файл - <tt>DocsExchangeT.acp#exp_handbooks.adg</tt><br>
</P>

<h2>Технология обмена документами.</h2>
<P align=left>Обмен документами, как и в случае настройки "Экспорт/импорт 
данных...", выполняется преобразованием данных из БД-источника в
некоторый промежуточный файл (экспорт) и последующим преобразованием 
данного файла в объекты БД-приемника (импорт). Как и в предыдущей 
настройке в качестве промежуточного используется XML-файл.</P>
<!--P align=left>Для того что бы выполнить экспорт документов, необходимо
любым из известных способов запустить диалог</P>
<TT>Dialogs\exp_main.adg<BR></TT>
<P align=left>а также требуются следующие модули :</P>
<TT>Modules\exp_acceleration.avb<BR>
Modules\exp_accs.avb<BR>
Modules\exp_agents.avb<BR>
Modules\exp_curs.avb<BR>
Modules\exp_entities.avb<BR>
Modules\exp_facts.avb<BR>
Modules\exp_forms.avb<BR>
Modules\exp_main.avb<BR>
Modules\exp_miscs.avb<BR>
Modules\exp_ops.avb<BR>
Modules\exp_param.avb<BR>
Modules\exp_pl.avb<BR>
Modules\exp_series.avb<BR>
Modules\exp_units.avb<BR></TT><BR>
<P align=left>и диалог настройки экспорта </P>
<TT>Dialogs\exp_cfg.adg<BR></TT-->
<P align=left>В диалоге экспорта следует указать: 
<BR>-файл, который будет хранить данные; 
<BR>-откуда будет осуществляться экспорт данных ("все" - будет 
экспортироваться всё дерево документов; если указана конкретная 
папка - экспорт будет осуществляться из указанной папки с учетом 
вложенных папок; если указана подшивка - документы для экспорта 
будут браться из подшивки с учетом расположения в дереве 
документов (папок документов)).</P>
<P align=left>При необходимости в лиалоге настройки экспорта можно
включить или отключить экспорт в XML связанных документов.</P>
<P align=left>Как было сказано выше, экспорт бухгалтерских 
документов осуществляется с учетом их иерархического расположения 
в дереве документов (папок документов) независимо от того, что 
было указано в диалоге экспорта (все, папка, подшивка). Т.е. 
если папка для экспорта содержала некоторое дерево папок, 
в которых содержались документы, то при импорте эта структура 
будет воспроизведена. Если осуществлялся экспорт всего дерева 
папок, то при импорте будет восстановлена вся структура папки 
"Документы". Если осуществлялся экспорт из подшивки и бухгалтерские
документы, находящиеся в этой подшивке, расположены в различных 
папках, то структура папок при импорте будет восстановлена и 
документы попадут в те же папки, где они находились в базе-источнике.
</P>
<P align=left>В процессе экспорта в промежуточный файл 
записываются бухгалтерские документы, а затем только те 
корреспонденты, банки, счета, объекты учета, единицы измерения 
и формы, которые встречались в экспортированных документах. 
</P>
<P align=left>Процедура экспорта выполняется следующим образом. 
Бухгалтерские документы выбираются из указанной пользователем папки 
или подшивки с учетом иерархии вложенных папок. Для всех 
экспортированных документов выполняется экспорт задействованных 
в них корреспондентов, банков корреспондентов, бухгалтерских 
счетов, объектов учета, базовых и производных ед.изменения, 
объектов разное, валют, а также параметров и фактов данных объектов.
Для перечисленных объектов базы также учитывается иерархия их 
расположения в БД-источнике. Например, если в некоторой 
экспортируемой операции задействован Корреспондент, расположенный 
на самом конце ветки Корреспондентов, то будет экспортирована вся 
ветвь до корня дерева.</P>
<P align=left>По окончании экспорта предоставляется возможность 
посмотреть промежуточный XML-файл.</P>
<P align=left>Полученный файл может быть отправлен по электронной 
почте, курьером или выложен на сервер общего доступа.</P>

<P align=left>Ключевым моментом при импорте является идентификация 
объектов из БД-источника и БД-приемника. Любой объект ищется в 
БД-приемнике по GUID'у. Если объект с данным GUID в БД-приемнике 
не обнаружен, то создается новый объект с заданным GUID. Обратите 
внимание, что в этом случае в базах данных (в источнике и приемнике) 
появляются идентичные объекты с одинаковым GUID'ом. При следующем 
импорте данный объект будет обнаружен (по GUID) и его поля, по 
желанию оператора, могут быть согласованы (или не согласованы) 
с полями объекта из XML-Файла (из БД-источника).</P>
<P align=left>Таким образом, бухгалтерские документы, корреспонденты,
объекты учета, банки, базовые и производные единицы измерения, 
объекты разное могут передаваться из одной БД в другую с 
отслеживанием всех изменений, происходящих с данными объектами в 
течении их жизни.</P>

<P align=left>Получив промежуточный XML-файл, оператор может 
выполнять процедуру импорта в БД-приемник, выполнив любым 
известным ему способом диалог :</P>
<TT>imp_main.adg<BR></TT><!--P align=left>Для функционирования данного диалога необходимы 
следующик модули :</P><TT>Modules\imp_accs.avb<BR>
Modules\imp_agents.avb<BR>
Modules\imp_banks.avb<BR>
Modules\imp_curs.avb<BR>
Modules\imp_entities.avb<BR>
Modules\imp_facts.avb<BR>
Modules\imp_forms.avb<BR>
Modules\imp_lateLink.avb<BR>
Modules\imp_main.avb<BR>
Modules\imp_miscs.avb<BR>
Modules\imp_ops.avb<BR>
Modules\imp_param.avb<BR>
Modules\imp_pl.avb<BR>
Modules\imp_series.avb<BR>
Modules\imp_units.avb<BR></TT><BR>
<P align=left>а также диалог настройки импорта</P><TT>Dialods\imp_cfg.adg<BR></TT>
<P align=left></P-->
<P align=left>В диалоге необходимо указать путь и имя файла, содержащего 
данные для импорта.</P>
<P align=left>При необходимости можно осуществить и "тонкую" 
настройку импорта (кнопка "Настройка"):<BR>-указать каким образом 
документы будут вставляться в базу данных ("как есть", "как 
проведенные" или "как не проведенные");<BR>-изменить способ 
идентификации для объектов "Коррепондент" и "Объект учета";
<BR>-подтвердить изменение свойств (полей) у найденных элементов 
в соответствии с полученнми из XML-файла данными;<BR>-указать нужно 
ли импортировать партии для объектов учета.</P>
<P align=left>В случае возникновения ошибок импорта будет сформирован
лог-файл, в котором будет описана возникшая проблема. В случае если 
самостоятельно не удается ликвидировать ошибки импорта, данный лог-файл
и файл, из которого осуществлялся импорт, следует сохранить и 
предоставить сотруднику "Импакт".</P>

<h2>Дополнительные средства.</h2>
<P align=left>В качестве дополнительного инстумента для данной настройки
предлагается диалог экспорта справочников</P>
<TT>exp_handbooks.adg<BR></TT>
<!--P align=left>Для функционирования данного диалога необходим модуль</P>
<TT>Modules\exp_handbooks.avb<BR></TT-->
<P align=left>Данный диалог выпоняет экспорт указанных справочников 
в XML-файл. Процедура импорта выполняется тем же диалогом импорта,
что и при импорте документов. Технологии и принципы экспорта/импорта
такие же как и описанные выше.</P>
<P align=left></P>

<P><A href="#start"><IMG hspace=8 src="../Images/Arrtop.gif" border=0>В начало</A></P>
<P class=COPYRIGHT>© 2001 Impact Group Ltd. Все права защищены.</P></TT></TT>
</BODY>
</HTML>
