<HTML>
<HEAD>
<META HTTP-EQUIV="Content-Type" CONTENT="text/html; charset=windows-1251"> 
<TITLE>Заголовок</TITLE>
<LINK rel="stylesheet" type="text/css" href="base.css">
</HEAD>
<BODY>
<A name="start"></A>
<H1>Обмен бухгалтерскими документами между БД семейства АКЦЕНТ версии 6.0.</H1>
<P align=left>15 декабря 2001 г.</P>
<P align=left>Настройка "Обмен данными..." является правопреемницей, 
наследницей, логическим продолжением настройки "Экспорт/импорт 
данных...".</P>
<P align=left>Ключевой особенностью данной настройки является 
иднтификация объектов баз данных по GIUD'ам (глобальным 
идентификаторам).GUID, представляющий собой 128-битную строку 
и являющийся уникальным идентификатором любого объекта, присваивается 
объекту базы данных при его создани и однозначно идентифицирует 
его на протяжнии "жизни" объекта.</P>
<P align=left>Это свойство уникальности GUID'а и используется для
идентификации объектов баз данных при обмене бухгалтерскими 
документами.</P>

<h2>Технология обмена документами.</h2>
<P align=left>Обмен документами, как и в случае настройки "Экспорт/импорт 
данных...", выполняется преобразованием данных из БД-источника в
некоторый промежуточный файл (экспорт) и последующим преобразованием 
данного файла в объекты БД-приемника (импорт). Как и в предыдущей 
настройке в качестве промежуточного используется XML-файл.</P>
<P align=left>Для того что бы выполнить экспорт документов, необходимо
любым из известных способов запустить диалог</P>
<TT>Dialogs\exp_main.adg<BR>
Dialogs\exp_cfg.adg<BR>
</TT>
<P align=left>а также требуются следующие модули :</P>
<P>
<TT>Modules\exp_acceleration.avb<BR>
Modules\exp_accs.avb<BR>
Modules\exp_agents.avb<BR>
Modules\exp_curs.avb<BR>
Modules\exp_entities.avb<BR>
Modules\exp_facts.avb<BR>
Modules\exp_forms.avb<BR>
Modules\exp_imp_parseScript.avb<BR>
Modules\exp_main.avb<BR>
Modules\exp_miscs.avb<BR>
Modules\exp_ops.avb<BR>
Modules\exp_param.avb<BR>
Modules\exp_pl.avb<BR>
Modules\exp_series.avb<BR>
Modules\exp_templates.avb<BR>
Modules\exp_units.avb<BR></TT><BR></P>
<P align=left>и диалог настройки экспорта </P>
<TT>Dialogs\exp_cfg.adg<BR></TT>
<P align=left>В диалоге экспорта следует указать: 
<BR>-файл, который будет хранить данные; 
<BR>-откуда будет осуществляться экспорт данных ("все" - будет 
экспортироваться всё дерево документов; если указана конкретная 
папка - экспорт будет осуществляться из указанной папки с учетом 
вложенных папок; если указана подшивка - документы для экспорта 
будут браться из подшивки с учетом расположения в дереве 
документов (папок документов)).</P>
<P align=left>При необходимости в диалоге настройки экспорта можно
включить или отключить:
<br>-экспорт в XML шаблонов бухгалтерских документов;
<br>-экспорт в XML связанных документов;
<br>-удалять бухгалтерские документы после экспорта из подшивки.</P>
<P align=left>Как было сказано выше, экспорт бухгалтерских 
документов осуществляется с учетом их иерархического расположения 
в дереве документов (папок документов) независимо от того, что 
было указано в диалоге экспорта (все, папка, подшивка). Т.е. 
если папка для экспорта содержала некоторое дерево папок, 
в которых содержались документы, то при импорте эта структура 
будет воспроизведена. Если осуществлялся экспорт всего дерева 
папок, то при импорте будет восстановлена вся структура папки 
"Документы". Если осуществлялся экспорт из подшивки и бухгалтерские
документы, находящиеся в этой подшивке, расположены в различных 
папках, то структура папок при импорте будет восстановлена и 
документы попадут в те же папки, где они находились в базе-источнике.
</P>
<P align=left>В процессе экспорта в промежуточный файл 
записываются бухгалтерские документы, а затем только те 
корреспонденты, банки, счета, объекты учета, единицы измерения 
и формы, которые встречались в экспортированных документах. 
</P>
<P align=left>Процедура экспорта выполняется следующим образом. 
Бухгалтерские документы выбираются из указанной пользователем папки 
или подшивки с учетом иерархии вложенных папок. Для всех 
экспортированных документов выполняется экспорт задействованных 
в них корреспондентов, банков корреспондентов, бухгалтерских 
счетов, объектов учета, базовых и производных ед.изменения, 
объектов разное, валют, а также параметров и фактов данных объектов.
Для перечисленных объектов базы также учитывается иерархия их 
расположения в БД-источнике. Например, если в некоторой 
экспортируемой операции задействован Корреспондент, расположенный 
на самом конце ветки Корреспондентов, то будет экспортирована вся 
ветвь до корня дерева.</P>
<P align=left>По окончании экспорта предоставляется возможность 
посмотреть промежуточный XML-файл.</P>
<P align=left>Полученный файл может быть отправлен по электронной 
почте, курьером или выложен на сервер общего доступа.</P>

<P align=left>Ключевым моментом при импорте является идентификация 
объектов из БД-источника и БД-приемника. Любой объект ищется в 
БД-приемнике по GUID'у. Если объект с данным GUID в БД-приемнике 
не обнаружен, то создается новый объект с заданным GUID. Обратите 
внимание, что в этом случае в базах данных (в источнике и приемнике) 
появляются идентичные объекты с одинаковым GUID'ом. При следующем 
импорте данный объект будет обнаружен (по GUID) и его поля, по 
желанию оператора, могут быть согласованы (или не согласованы) 
с полями объекта из XML-Файла (из БД-источника).</P>
<P align=left>Таким образом, бухгалтерские документы, корреспонденты,
объекты учета, банки, базовые и производные единицы измерения, 
объекты разное могут передаваться из одной БД в другую с 
отслеживанием всех изменений, происходящих с данными объектами в 
течении их жизни.</P>

<P align=left>Получив промежуточный XML-файл, оператор может 
выполнять процедуру импорта в БД-приемник, выполнив любым 
известным ему способом диалог :</P>
<TT>Dialods\imp_main.adg<BR>
Dialods\imp_cfg.adg<BR></TT>
<P align=left>Для функционирования данного диалога необходимы 
следующик модули :</P><TT>
Modules\exp_imp_parseScript.avb<BR>
Modules\imp_accs.avb<BR>
Modules\imp_agents.avb<BR>
Modules\imp_banks.avb<BR>
Modules\imp_curs.avb<BR>
Modules\imp_entities.avb<BR>
Modules\imp_facts.avb<BR>
Modules\imp_forms.avb<BR>
Modules\imp_lateLink.avb<BR>
Modules\imp_main.avb<BR>
Modules\imp_miscs.avb<BR>
Modules\imp_ops.avb<BR>
Modules\imp_param.avb<BR>
Modules\imp_pl.avb<BR>
Modules\imp_series.avb<BR>
Modules\imp_templates.avb<BR>
Modules\imp_units.avb<BR></TT><BR>
<P align=left></P>В диалоге <TT>imp_main.adg</TT> необходимо указать путь и имя файла, 
содержащего данные для импорта.
<P></P>
<P align=left>При необходимости можно осуществить и "тонкую" 
настройку импорта (кнопка "Настройка"):<BR>-указать каким образом 
документы будут вставляться в базу данных ("как есть", "как 
проведенные" или "как не проведенные");<BR>-изменить способ 
идентификации для объектов "Коррепондент", "Объект учета", "Счет";
<BR>-подтвердить изменение свойств (полей) у найденных элементов 
в соответствии с полученнми из XML-файла данными;<BR>-указать нужно 
ли импортировать партии для объектов учета.</P>
<P align=left>В случае возникновения ошибок импорта будет сформирован
лог-файл, в котором будет описана возникшая проблема. В случае если 
самостоятельно не удается ликвидировать ошибки импорта, данный лог-файл
и файл, из которого осуществлялся импорт, следует сохранить и 
предоставить сотруднику "Импакт".</P>

<h2>Дополнительные средства.</h2>
<P align=left>В качестве дополнительного инстумента для данной настройки
предлагается диалог экспорта справочников</P>
<TT>Dialods\exp_handbooks.adg<BR></TT>
<P align=left>Для функционирования данного диалога необходим модуль</P>
<TT>Modules\exp_handbooks.avb<BR></TT>
<P align=left>и диалог</P>
<TT>Modules\exp_hbooks_se.avb<BR></TT>
<P align=left>Данный диалог выпоняет экспорт указанных справочников 
в XML-файл. Процедура импорта выполняется тем же диалогом импорта,
что и при импорте документов. Технологии и принципы экспорта/импорта
такие же как и описанные выше.</P>
<P align=left></P>

<P><A href="#start"><IMG hspace=8 src="../Images/Arrtop.gif" border=0>В начало</A></P>
<P class=COPYRIGHT>© 2001 Impact Group Ltd. Все права защищены.</P>
</BODY>
</HTML>
