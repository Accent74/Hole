<AccentExportData>
	<AccentOperations/>
	<AccentFolders>
		<folder ID="583" GUID="{guid {C1B4CA87-87FB-4F2C-8C89-566CF75F7888}}" Name="Основные средства" FormID="0" FormGUID="" Tag="" TID="0" TGUID="" Type="0">
			<folder ID="586" GUID="{guid {CAE10774-820B-4432-AE95-66BD8EEC15C9}}" Name="3. ОС. Ввод в эксплуатацию" FormID="930" FormGUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}" Tag="" TID="0" TGUID="" Type="0"/>
			<folder ID="589" GUID="{guid {B5CD6246-02AA-4A7A-9DF7-AFCF68879275}}" Name="5. ОС. Начисление амортизации" FormID="932" FormGUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}" Tag="" TID="0" TGUID="" Type="0"/>
			<folder ID="585" GUID="{guid {CF8D3BC7-1681-4AD5-A90D-00A7556FBAB9}}" Name="2. ОС. Внутреннее перемещение" FormID="0" FormGUID="" Tag="" TID="1905" TGUID="{guid {6AD45B6E-9B20-49A3-8E7E-BAC53927D415}}" Type="0"/>
			<folder ID="584" GUID="{guid {440FCB17-B342-4E1A-8848-2E2D2ECB34E5}}" Name="1. ОС.Поступление" FormID="0" FormGUID="" Tag="" TID="1903" TGUID="{guid {27969F77-4AB0-4FDF-A2FF-BFB4682372D3}}" Type="0"/>
		</folder>
		<folder ID="499" GUID="{guid {FC4C20EE-A498-4364-9C2C-382A1EFBC19E}}" Name="Товары" FormID="0" FormGUID="" Tag="" TID="0" TGUID="" Type="0">
			<folder ID="531" GUID="{guid {3AD1A31E-6494-4832-8A87-9E5C78AE0807}}" Name="10. Товары. Инвентаризационная опись" FormID="0" FormGUID="" Tag="" TID="1878" TGUID="{guid {DE36291D-893C-41C6-BBF3-ECC9734C6000}}" Type="0"/>
			<folder ID="514" GUID="{guid {06A46935-02F7-4B53-A814-9FCAA571E8F1}}" Name="04. Товары. Реализация" FormID="0" FormGUID="" Tag="" TID="1762" TGUID="{guid {2C9C36EC-B46D-47C4-A9A8-7A017302CB3E}}" Type="0"/>
			<folder ID="515" GUID="{guid {E89A218F-33BF-4920-8A83-FD2A8397AAE9}}" Name="06. Товары. Возврат от покупателя" FormID="0" FormGUID="" Tag="" TID="1807" TGUID="{guid {14F0DFAA-72B1-4EE7-8189-8D2F8375D867}}" Type="0"/>
			<folder ID="516" GUID="{guid {1170FBCF-3A97-4E23-8B5C-7E67059A125B}}" Name="07. Товары. Возврат поставщику" FormID="0" FormGUID="" Tag="" TID="1808" TGUID="{guid {DE7598DD-D135-4019-BCF8-B2195FDBF4F0}}" Type="0"/>
			<folder ID="567" GUID="{guid {CF6AE135-D711-4841-A068-4F2A987EAC19}}" Name="08. Товары. Товаро-транспортные накладные" FormID="0" FormGUID="" Tag="" TID="0" TGUID="" Type="0">
				<folder ID="529" GUID="{guid {A0709152-B716-411B-B0D4-2C5EB48E975D}}" Name="08.01. Товары. Товарно транспортная накладная" FormID="0" FormGUID="" Tag="" TID="1821" TGUID="{guid {47EBEE31-3D36-4F9E-9C54-59D247A75CAF}}" Type="0"/>
				<folder ID="566" GUID="{guid {9957DA78-3654-4D52-BB24-0F230F071605}}" Name="08.02. Товары. Товаро-транспортная накладная (ГТД)" FormID="907" FormGUID="{guid {D144A241-1ADE-4461-A952-914F0BBEA9A6}}" Tag="" TID="0" TGUID="" Type="0"/>
			</folder>
		</folder>
		<folder ID="549" GUID="{guid {E444903A-DDE1-4830-AAAA-5714C3AC79A2}}" Name="Магазин" FormID="0" FormGUID="" Tag="" TID="0" TGUID="" Type="0">
			<folder ID="554" GUID="{guid {5FEB07B6-31BB-4D5B-8438-5F0EB3876B8E}}" Name="06. Магазин. Возврат от покупателя" FormID="0" FormGUID="" Tag="" TID="1858" TGUID="{guid {50344DF5-5A26-46AD-B8FF-23F47102612C}}" Type="0"/>
			<folder ID="555" GUID="{guid {7A1DD19A-0D95-440B-923C-49EEB600DA84}}" Name="07. Магазин. Возврат поставщику" FormID="0" FormGUID="" Tag="" TID="1860" TGUID="{guid {B433E27C-B6E0-4D85-92B7-B72239754019}}" Type="0"/>
			<folder ID="553" GUID="{guid {C963C924-ED0B-4948-ABAD-E946EA67404F}}" Name="03. Магазин. Реализация товара" FormID="0" FormGUID="" Tag="" TID="1868" TGUID="{guid {1C540293-51A0-48DE-92C7-6D8351891456}}" Type="0"/>
		</folder>
		<folder ID="532" GUID="{guid {D8C9F333-2A48-4F63-A315-AC2242C086D8}}" Name="Производство" FormID="0" FormGUID="" Tag="" TID="0" TGUID="" Type="0">
			<folder ID="535" GUID="{guid {86704DC4-ACA1-4ECE-BBCC-1CD235A0048E}}" Name="2. Производство. Реализация готовой продукции" FormID="0" FormGUID="" Tag="" TID="1765" TGUID="{guid {45EB470B-DABF-442C-B933-E3143B2EA7BD}}" Type="0"/>
		</folder>
	</AccentFolders>
	<AccentTemplates>
		<template GUID="{guid {10608E95-1D21-431D-9F0E-B1240B23EBCE}}" ID="1901" Memo="" Name="ОС. Основные средства" Tag="" Type="0" FormID="0" FormGUID="" Script="">
			<template GUID="{guid {95788CDE-2A4E-4774-8B72-92A9B54A7D19}}" ID="1906" Memo="" Name="ОС. Ввод в эксплуатацию" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {BC821B7B-2844-4BBA-BAB0-F6A3C2FE723C}}" ID="1907" Memo="" Name="ОС. Ввод в эксплуатацию зданий и сооружений (103)" Tag="" Type="1" FormID="930" FormGUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 930
  op.SetFolder 586
  op.Name2 = &quot;ОС. Ввод в эксплуатацию зданий и сооружений (103)&quot;
  '--Счета--
  op.TransList(1).SetAccDb 111
  op.TransList(1).SetAccCr 156
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {6D749521-8402-46A4-9493-707D7B7EE392}}
  op.SetFolder {guid {CAE10774-820B-4432-AE95-66BD8EEC15C9}}
  op.Name2 = "ОС. Ввод в эксплуатацию зданий и сооружений (103)"
  '--Счета--
  op.TransList(1).SetAccDb {guid {95D51555-0595-4C02-9423-6ABB83F2A099}}
  op.TransList(1).SetAccCr {guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/6/2016 9:55:45 AM"/>
					</parameters>
				</template>
				<template GUID="{guid {833BDA89-F923-49B6-A47E-1E73041438CC}}" ID="1916" Memo="" Name="ОС. Ввод в эксплуатацию инструмента, приборов и инвентаря (106)" Tag="" Type="1" FormID="930" FormGUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 930
  op.SetFolder 586
  op.Name2 = &quot;ОС. Ввод в эксплуатацию инструмента, приборов и инвентаря (106)&quot;
  '--Счета--
  op.TransList(1).SetAccDb 117
  op.TransList(1).SetAccCr 156
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {6D749521-8402-46A4-9493-707D7B7EE392}}
  op.SetFolder {guid {CAE10774-820B-4432-AE95-66BD8EEC15C9}}
  op.Name2 = "ОС. Ввод в эксплуатацию инструмента, приборов и инвентаря (106)"
  '--Счета--
  op.TransList(1).SetAccDb {guid {F417A3C9-D9E0-4081-885B-41544D563A02}}
  op.TransList(1).SetAccCr {guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

				</template>
				<template GUID="{guid {A29C6071-8737-48F4-8528-4383C84C1CD3}}" ID="1914" Memo="" Name="ОС. Ввод в эксплуатацию машин и оборудования (104)" Tag="" Type="1" FormID="930" FormGUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 930
  op.SetFolder 586
  op.Name2 = &quot;ОС. Ввод в эксплуатацию машин и оборудования (104)&quot;
  '--Счета--
  op.TransList(1).SetAccDb 113
  op.TransList(1).SetAccCr 156
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {6D749521-8402-46A4-9493-707D7B7EE392}}
  op.SetFolder {guid {CAE10774-820B-4432-AE95-66BD8EEC15C9}}
  op.Name2 = "ОС. Ввод в эксплуатацию машин и оборудования (104)"
  '--Счета--
  op.TransList(1).SetAccDb {guid {649CB862-D2CD-4A99-98B3-76DB82505B52}}
  op.TransList(1).SetAccCr {guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

				</template>
				<template GUID="{guid {3FAB7767-4CAD-442C-9B64-D7F430BD10C1}}" ID="1917" Memo="" Name="ОС. Ввод в эксплуатацию прочих основных средств (109)" Tag="" Type="1" FormID="930" FormGUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 930
  op.SetFolder 586
  op.Name2 = &quot;ОС. Ввод в эксплуатацию прочих основных средств (109)&quot;
  '--Счета--
  op.TransList(1).SetAccDb 121
  op.TransList(1).SetAccCr 156
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {6D749521-8402-46A4-9493-707D7B7EE392}}
  op.SetFolder {guid {CAE10774-820B-4432-AE95-66BD8EEC15C9}}
  op.Name2 = "ОС. Ввод в эксплуатацию прочих основных средств (109)"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6FEC91A2-FBDC-4314-880F-D33F3A52AA0D}}
  op.TransList(1).SetAccCr {guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

				</template>
				<template GUID="{guid {EC2E962A-7C21-48CE-BF45-26B062AECC39}}" ID="1915" Memo="" Name="ОС. Ввод в эксплуатацию транспортных средств (105)" Tag="" Type="1" FormID="930" FormGUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 930
  op.SetFolder 586
  op.Name2 = &quot;ОС. Ввод в эксплуатацию транспортных средств (105)&quot;
  '--Счета--
  op.TransList(1).SetAccDb 115
  op.TransList(1).SetAccCr 156
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {6D749521-8402-46A4-9493-707D7B7EE392}}
  op.SetFolder {guid {CAE10774-820B-4432-AE95-66BD8EEC15C9}}
  op.Name2 = "ОС. Ввод в эксплуатацию транспортных средств (105)"
  '--Счета--
  op.TransList(1).SetAccDb {guid {BB7B1A2B-4D60-4609-B95D-AA7EA09A2046}}
  op.TransList(1).SetAccCr {guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

				</template>
			</template>
			<template GUID="{guid {E1B1EF88-DF3F-4A9D-9973-174E1DFD3D3D}}" ID="1908" Memo="" Name="ОС. Начисление амортизации" Tag="" Type="0" FormID="0" FormGUID="" Script="">
			
				<template GUID="{guid {1585D43B-4AD6-47D7-91F3-3E5C1D8502EA}}" ID="1909" Memo="" Name="ОС. Начисление амортизации на здания и сооружения (103)" Tag="" Type="1" FormID="932" FormGUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 932
  op.SetFolder 589
  op.Name2 = &quot;ОС. Начисление амортизации на здания и сооружения (103)&quot;
  '--Счета--
  op.TransList(1).SetAccCr 142
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}
  op.SetFolder {guid {B5CD6246-02AA-4A7A-9DF7-AFCF68879275}}
  op.Name2 = "ОС. Начисление амортизации на здания и сооружения (103)"
  '--Счета--
  op.TransList(1).SetAccCr {guid {D9D0C650-AD87-470C-A4CE-B412C10D7634}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/6/2016 10:28:31 AM"/>
					</parameters>
				</template>
				<template GUID="{guid {D16EAAA7-48FB-48AE-AB5C-77709576A7E1}}" ID="1912" Memo="" Name="ОС. Начисление амортизации на инструменты, приборы и инвентарь (106)" Tag="" Type="1" FormID="932" FormGUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 932
  op.SetFolder 589
  op.Name2 = &quot;ОС. Начисление амортизации на инструменты, приборы и инвентарь (106)&quot;
  '--Счета--
  op.TransList(1).SetAccCr 145
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}
  op.SetFolder {guid {B5CD6246-02AA-4A7A-9DF7-AFCF68879275}}
  op.Name2 = "ОС. Начисление амортизации на инструменты, приборы и инвентарь (106)"
  '--Счета--
  op.TransList(1).SetAccCr {guid {1EB518B1-D07B-40BF-A8AA-96D7BFC7CC76}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/6/2016 10:28:41 AM"/>
					</parameters>
				</template>
				<template GUID="{guid {CAE7179F-0103-473E-8BEA-8A2A5B7A01D9}}" ID="1910" Memo="" Name="ОС. Начисление амортизации на машины и оборудование (104)" Tag="" Type="1" FormID="932" FormGUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 932
  op.SetFolder 589
  op.Name2 = &quot;ОС. Начисление амортизации на машины и оборудование (104)&quot;
  '--Счета--
  op.TransList(1).SetAccCr 143
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}
  op.SetFolder {guid {B5CD6246-02AA-4A7A-9DF7-AFCF68879275}}
  op.Name2 = "ОС. Начисление амортизации на машины и оборудование (104)"
  '--Счета--
  op.TransList(1).SetAccCr {guid {FE68D619-5A98-4DCA-90AA-D1F7A50A3AF5}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/6/2016 10:28:48 AM"/>
					</parameters>
				</template>
				<template GUID="{guid {F099C5FA-4D6E-4E7B-A0FA-393E03D67F64}}" ID="1913" Memo="" Name="ОС. Начисление амортизации на Прочие основные средства (109)" Tag="" Type="1" FormID="932" FormGUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 932
  op.SetFolder 589
  op.Name2 = &quot;ОС. Начисление амортизации на Прочие основные средства (109)&quot;
  '--Счета--
  op.TransList(1).SetAccCr 147
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}
  op.SetFolder {guid {B5CD6246-02AA-4A7A-9DF7-AFCF68879275}}
  op.Name2 = "ОС. Начисление амортизации на Прочие основные средства (109)"
  '--Счета--
  op.TransList(1).SetAccCr {guid {15E31CBA-6ECE-48CC-B3BB-64997C430D91}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/6/2016 10:28:27 AM"/>
					</parameters>
				</template>
				<template GUID="{guid {65DE8D4F-EB8F-4930-9AE7-F2596CFBA6DE}}" ID="1911" Memo="" Name="ОС. Начисление амортизации на транспортные средства (105)" Tag="" Type="1" FormID="932" FormGUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 932
  op.SetFolder 589
  op.Name2 = &quot;ОС. Начисление амортизации на транспортные средства (105)&quot;
  '--Счета--
  op.TransList(1).SetAccCr 144
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}
  op.SetFolder {guid {B5CD6246-02AA-4A7A-9DF7-AFCF68879275}}
  op.Name2 = "ОС. Начисление амортизации на транспортные средства (105)"
  '--Счета--
  op.TransList(1).SetAccCr {guid {68984B66-DF8B-4291-B387-F63AB6EB1BBE}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/6/2016 10:28:56 AM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {73D2095D-B8E9-40EC-BB4E-E1D337DD24BA}}" ID="1904" Memo="" Name="ОС. Перемещение ОС" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {6AD45B6E-9B20-49A3-8E7E-BAC53927D415}}" ID="1905" Memo="" Name="ОС. Перемещение ОС" Tag="" Type="1" FormID="929" FormGUID="{guid {98D0CD2E-DA6C-4FB2-AE37-8735B521D904}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = 929
  op.SetFolder 585
  op.Name = &quot;ОС. Акт приема передачи ОС&quot;
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H8
  '--Блокировки--
  op.TransList(1).LockUI &amp;H2
  op.TransList(2).LockUI &amp;H7A
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Объекты учета--
  op.CopyEntities 2, 1
  '--Счета--
  op.CopyAccounts 1, False, 1, True
  op.CopyAccounts 2, False, 2, True
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  '--Количества--
  op.TransList(2).CalcQty &quot;=Q1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = {guid {98D0CD2E-DA6C-4FB2-AE37-8735B521D904}}
  op.SetFolder {guid {CF8D3BC7-1681-4AD5-A90D-00A7556FBAB9}}
  op.Name = "ОС. Акт приема передачи ОС"
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H8
  '--Блокировки--
  op.TransList(1).LockUI &amp;H2
  op.TransList(2).LockUI &amp;H7A
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Объекты учета--
  op.CopyEntities 2, 1
  '--Счета--
  op.CopyAccounts 1, False, 1, True
  op.CopyAccounts 2, False, 2, True
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  '--Количества--
  op.TransList(2).CalcQty "=Q1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="6/25/2016 1:58:29 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {F042216B-09B3-4739-88D2-81AEB9D99F5B}}" ID="1902" Memo="" Name="ОС. Поступление ОС" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {27969F77-4AB0-4FDF-A2FF-BFB4682372D3}}" ID="1903" Memo="" Name="ОС. Поступление ОС" Tag="" Type="1" FormID="931" FormGUID="{guid {792D7059-B0E1-445B-AF82-52245FF29393}}" Script="'#include &quot;HL74_MakeSeries2DAO.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeries2(Op, 1)
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 931
  op.SetFolder 584
  op.Name = &quot;ОС. Поступление ОС&quot;
  '--Счета--
  op.TransList(1).SetAccDb 156
  op.TransList(1).SetAccCr 299
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, &quot;Д.Б.&quot;
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
">'#include "HL74_MakeSeries2DAO.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeries2(Op, 1)
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {792D7059-B0E1-445B-AF82-52245FF29393}}
  op.SetFolder {guid {440FCB17-B342-4E1A-8848-2E2D2ECB34E5}}
  op.Name = "ОС. Поступление ОС"
  '--Счета--
  op.TransList(1).SetAccDb {guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, "Д.Б."
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:45:17 PM"/>
					</parameters>
				</template>
			</template>
		</template>
		<template GUID="{guid {314B0155-9035-4137-8B4E-C007C00ABEA7}}" ID="1739" Memo="" Name="Товары" Tag="" Type="0" FormID="0" FormGUID="" Script="Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 775
  op.SetFolder 529
  op.Name2 = &quot;Товары. Товарно-транспортная накладная&quot;
  '--Счета--
  op.TransList(1).SetAccDb 570
  op.TransList(1).SetAccCr 570
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {B9964DBF-B3A8-4150-B8C8-ED651A823F3E}}
  op.SetFolder {guid {A0709152-B716-411B-B0D4-2C5EB48E975D}}
  op.Name2 = "Товары. Товарно-транспортная накладная"
  '--Счета--
  op.TransList(1).SetAccDb {guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}
  op.TransList(1).SetAccCr {guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

			<template GUID="{guid {0E8166D3-4411-4577-8BF5-2DCA1407E9B9}}" ID="1823" Memo="" Name="Товары. Переоценка и инветаризация" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {DE36291D-893C-41C6-BBF3-ECC9734C6000}}" ID="1878" Memo="" Name="Товары. Инвентаризационная опись" Tag="" Type="1" FormID="691" FormGUID="{guid {97E2CEB9-8A05-4812-852A-292730DBBE2A}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = 691
  op.SetFolder 531
  op.Name = &quot;Товары. Инвентаризационная опись&quot;
  '--Счета--
  op.TransList(1).SetAccDb 69
  op.TransList(1).SetAccCr 69
  op.TransList(2).SetAccDb 416
  op.TransList(2).SetAccCr 195
  op.TransList(3).SetAccDb 195
  op.TransList(3).SetAccCr 361
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  op.CopyAgents 3, False, 1, False
  op.CopyAgents 3, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = {guid {97E2CEB9-8A05-4812-852A-292730DBBE2A}}
  op.SetFolder {guid {3AD1A31E-6494-4832-8A87-9E5C78AE0807}}
  op.Name = "Товары. Инвентаризационная опись"
  '--Счета--
  op.TransList(1).SetAccDb {guid {D7ACAED9-296D-11D3-A02D-0080480180F7}}
  op.TransList(1).SetAccCr {guid {D7ACAED9-296D-11D3-A02D-0080480180F7}}
  op.TransList(2).SetAccDb {guid {A939FC4C-2442-4A43-B22F-D6E4671233D5}}
  op.TransList(2).SetAccCr {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(3).SetAccDb {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(3).SetAccCr {guid {758E9105-7344-43D3-B72C-8182F2C3B5EA}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  op.CopyAgents 3, False, 1, False
  op.CopyAgents 3, True, 1, False
  '--Суммы--
  op.CalcSum "=T1+T2"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="5/23/2016 7:54:23 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {0301F93B-6209-46B0-AEEF-34F18E9C8EF7}}" ID="1750" Memo="" Name="Товары. Поступление" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {BC0B8065-33E3-4787-B585-1DB72A8414EC}}" ID="1809" Memo="" Name="Товары. Поступление. Поступление товара от поставщика" Tag="" Type="1" FormID="319" FormGUID="{guid {87905062-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_MakeSeries2DAO.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeries2(Op, 1)
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = 319
  op.Name = &quot;Товары. Поступление. Поступление товара от поставщика&quot;
  '--Счета--
  op.TransList(1).SetAccDb 195
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 195
  op.TransList(2).SetAccCr 176
  op.TransList(3).SetAccDb 176
  op.TransList(3).SetAccCr 299
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  op.TransList(1).settax ДПУ-Б, &quot;Д.Б.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H8
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  op.CopyAgents 3, False, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  '}} END_RECALC
End Sub
">'#include "HL74_MakeSeries2DAO.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeries2(Op, 1)
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = {guid {87905062-D1EE-11D5-8141-0002440B6A16}}
  op.Name = "Товары. Поступление. Поступление товара от поставщика"
  '--Счета--
  op.TransList(1).SetAccDb {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(2).SetAccCr {guid {4FDB4ACE-9573-4D40-830C-8A57EEF113D6}}
  op.TransList(3).SetAccDb {guid {4FDB4ACE-9573-4D40-830C-8A57EEF113D6}}
  op.TransList(3).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  op.TransList(1).settax ДПУ-Б, "Д.Б."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H8
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  op.CopyAgents 3, False, 1, False
  '--Суммы--
  op.CalcSum "=T1+T2"
  '}} END_RECALC
End Sub
					<lnk_tt id="1872"/>
					<lnk_tt id="1821"/>
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:38:15 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {46D581B3-0527-48BD-9EA6-513FFCC5E443}}" ID="1751" Memo="" Name="Товары. Реализация" Tag="" Type="0" FormID="0" FormGUID="" Script="Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 775
  op.SetFolder 529
  op.Name2 = &quot;Товары. Товарно-транспортная накладная&quot;
  '--Счета--
  op.TransList(1).SetAccDb 570
  op.TransList(1).SetAccCr 570
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {B9964DBF-B3A8-4150-B8C8-ED651A823F3E}}
  op.SetFolder {guid {A0709152-B716-411B-B0D4-2C5EB48E975D}}
  op.Name2 = "Товары. Товарно-транспортная накладная"
  '--Счета--
  op.TransList(1).SetAccDb {guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}
  op.TransList(1).SetAccCr {guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

				<template GUID="{guid {2C9C36EC-B46D-47C4-A9A8-7A017302CB3E}}" ID="1762" Memo="" Name="Товары. Реализация собственного товара" Tag="" Type="1" FormID="320" FormGUID="{guid {87905063-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 6.0 
'= Создан : 05/11/2001 14:46:06
'= Автор : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 320
  op.SetFolder 514
  op.Name = &quot;Товары. Реализация собственного товара&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 335
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 195
  op.TransList(3).SetAccDb 335
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H39
  op.TransList(4).LockUI &amp;H39
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Объекты учета--
  op.CopyEntities 3, 1
  op.CopyEntities 4, 1
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=$1&quot;
  op.TransList(4).CalcSum &quot;=$2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
 '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
 '}} END_BEFORESAVEE
End Sub

">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 6.0 
'= Создан : 05/11/2001 14:46:06
'= Автор : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {87905063-D1EE-11D5-8141-0002440B6A16}}
  op.SetFolder {guid {06A46935-02F7-4B53-A814-9FCAA571E8F1}}
  op.Name = "Товары. Реализация собственного товара"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(3).SetAccDb {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H39
  op.TransList(4).LockUI &amp;H39
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Объекты учета--
  op.CopyEntities 3, 1
  op.CopyEntities 4, 1
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=$1"
  op.TransList(4).CalcSum "=$2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
 '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
 '}} END_BEFORESAVEE
End Sub

					<lnk_tt id="1872"/>
					<lnk_tt id="1821"/>
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="6/30/2016 3:52:33 PM"/>
					</parameters>
				</template>
				<template GUID="{guid {D7CDBB41-F0EE-4221-A8F7-DB8661ACD02D}}" ID="1766" Memo="" Name="Товары. Реализация комисионного товара" Tag="" Type="1" FormID="320" FormGUID="{guid {87905063-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 6.0 
'= Создан : 05/11/2001 14:46:06
'= Автор : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = 320
  op.SetFolder 514
  op.Name = &quot;Товары. Реализация комисионного товара&quot;
  '--Счета--
  op.TransList(1).SetAccDb 562
  op.TransList(1).SetAccCr 559
  op.TransList(2).SetAccDb 562
  op.TransList(2).SetAccCr 197
  op.TransList(3).SetAccDb 559
  op.TransList(3).SetAccCr 368
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
 '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
 '}} END_BEFORESAVEE
End Sub
">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 6.0 
'= Создан : 05/11/2001 14:46:06
'= Автор : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = {guid {87905063-D1EE-11D5-8141-0002440B6A16}}
  op.SetFolder {guid {06A46935-02F7-4B53-A814-9FCAA571E8F1}}
  op.Name = "Товары. Реализация комисионного товара"
  '--Счета--
  op.TransList(1).SetAccDb {guid {AA575F00-FEBA-4EB8-A204-48BE4EEEADF1}}
  op.TransList(1).SetAccCr {guid {803867A3-6BDA-4A64-A0BA-6812FA5515EC}}
  op.TransList(2).SetAccDb {guid {AA575F00-FEBA-4EB8-A204-48BE4EEEADF1}}
  op.TransList(2).SetAccCr {guid {0592227D-F1C6-4750-BED8-D634CB1FF52A}}
  op.TransList(3).SetAccDb {guid {803867A3-6BDA-4A64-A0BA-6812FA5515EC}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
 '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
 '}} END_BEFORESAVEE
End Sub
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:36:51 PM"/>
					</parameters>
				</template>
				<template GUID="{guid {E58C0822-896A-43B2-8D5C-F787520CD52D}}" ID="1835" Memo="" Name="Товары. Реализация собственного товара через кассу" Tag="" Type="1" FormID="320" FormGUID="{guid {87905063-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 6.0 
'= Создан : 05/11/2001 14:46:06
'= Автор : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 320
  op.SetFolder 514
  op.Name = &quot;Товары. Реализация собственного товара&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 335
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 195
  op.TransList(3).SetAccDb 335
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  op.TransList(5).SetAccDb 201
  op.TransList(5).SetAccCr 220
  '--Разное--
  op.TransList(1).SetMisc 13, 159
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H19
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 5, False, 2, True
  op.CopyAgents 5, True, 1, False
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T2&quot;
  op.TransList(5).CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
 '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 4, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
 '}} END_BEFORESAVEE
End Sub

">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 6.0 
'= Создан : 05/11/2001 14:46:06
'= Автор : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {87905063-D1EE-11D5-8141-0002440B6A16}}
  op.SetFolder {guid {06A46935-02F7-4B53-A814-9FCAA571E8F1}}
  op.Name = "Товары. Реализация собственного товара"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(3).SetAccDb {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(5).SetAccDb {guid {CCEBE0A5-5FD6-4E6B-82EC-D3BA9E55E2D9}}
  op.TransList(5).SetAccCr {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  '--Разное--
  op.TransList(1).SetMisc 13, {guid {E07C5D68-C67F-45E2-8067-D49510A07960}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H19
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 5, False, 2, True
  op.CopyAgents 5, True, 1, False
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=T1"
  op.TransList(4).CalcSum "=T2"
  op.TransList(5).CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
 '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 4, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
 '}} END_BEFORESAVEE
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:37:06 PM"/>
					</parameters>
				</template>
				<template GUID="{guid {47EBEE31-3D36-4F9E-9C54-59D247A75CAF}}" ID="1821" Memo="" Name="Товары. Товарно-транспортная накладная" Tag="" Type="1" FormID="775" FormGUID="{guid {B9964DBF-B3A8-4150-B8C8-ED651A823F3E}}" Script="Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 775
  op.SetFolder 529
  op.Name2 = &quot;Товары. Товарно-транспортная накладная&quot;
  '--Счета--
  op.TransList(1).SetAccDb 570
  op.TransList(1).SetAccCr 570
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {B9964DBF-B3A8-4150-B8C8-ED651A823F3E}}
  op.SetFolder {guid {A0709152-B716-411B-B0D4-2C5EB48E975D}}
  op.Name2 = "Товары. Товарно-транспортная накладная"
  '--Счета--
  op.TransList(1).SetAccDb {guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}
  op.TransList(1).SetAccCr {guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="6/1/2015 10:38:58 AM"/>
					</parameters>
				</template>
				<template GUID="{guid {A22F0667-9DB7-4904-8465-084E7F2997B9}}" ID="1872" Memo="" Name="Товары. Товарно-транспортная накладная (ГТД)" Tag="" Type="1" FormID="907" FormGUID="{guid {D144A241-1ADE-4461-A952-914F0BBEA9A6}}" Script="Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 907
  op.SetFolder 566
  op.Name = &quot;Товары. Товарно-транспортная накладная&quot;
  '--Счета--
  op.TransList(1).SetAccDb 572
  op.TransList(1).SetAccCr 572
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {D144A241-1ADE-4461-A952-914F0BBEA9A6}}
  op.SetFolder {guid {9957DA78-3654-4D52-BB24-0F230F071605}}
  op.Name = "Товары. Товарно-транспортная накладная"
  '--Счета--
  op.TransList(1).SetAccDb {guid {1D4F8450-AACB-409F-A654-9B36B9C35623}}
  op.TransList(1).SetAccCr {guid {1D4F8450-AACB-409F-A654-9B36B9C35623}}
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<lnk_tt id="1762"/>
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="1/29/2016 12:08:20 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {C85E27E7-434C-4B80-A9F1-2FA228F83EF8}}" ID="1754" Memo="" Name="Товары. Возврат от покупателя" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {14F0DFAA-72B1-4EE7-8189-8D2F8375D867}}" ID="1807" Memo="" Name="Товары. Возврат товара от покупателя" Tag="" Type="1" FormID="322" FormGUID="{guid {879051B0-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_ReturnToDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnTo(Op, 2, 1, 3, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 322
  op.SetFolder 515
  op.Name = &quot;Товары. Возврат товара от покупателя&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 559
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 195
  op.TransList(3).SetAccDb 559
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H19
  op.TransList(4).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T2&quot;
  '}} END_RECALC
End Sub
">'#include "HL74_ReturnToDAO.avb"
'#include "HL74_Errors.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnTo(Op, 2, 1, 3, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {879051B0-D1EE-11D5-8141-0002440B6A16}}
  op.SetFolder {guid {E89A218F-33BF-4920-8A83-FD2A8397AAE9}}
  op.Name = "Товары. Возврат товара от покупателя"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {803867A3-6BDA-4A64-A0BA-6812FA5515EC}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(3).SetAccDb {guid {803867A3-6BDA-4A64-A0BA-6812FA5515EC}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H19
  op.TransList(4).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=T1"
  op.TransList(4).CalcSum "=T2"
  '}} END_RECALC
End Sub
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:41:57 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {DD3A3038-A467-40A7-8B0D-AF561A709BE0}}" ID="1755" Memo="" Name="Товары. Возврат поставщику" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {DE7598DD-D135-4019-BCF8-B2195FDBF4F0}}" ID="1808" Memo="" Name="Товары. Возврат поставщику. Возврат товара поставщику" Tag="" Type="1" FormID="321" FormGUID="{guid {879051AF-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_ReturnFromDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If Not Workarea.Map(&quot;OpTagEval&quot;) Then Exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 321
  op.SetFolder 516
  op.Name = &quot;Товары. Возврат поставщику. Возврат товара поставщику&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 335
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 195
  op.TransList(3).SetAccDb 335
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, &quot;Д.Б.&quot;
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H39
  op.TransList(4).LockUI &amp;H39
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Объекты учета--
  op.CopyEntities 3, 1
  op.CopyEntities 4, 1
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=$1&quot;
  op.TransList(4).CalcSum &quot;=$2&quot;
  '}} END_RECALC
End Sub
">'#include "HL74_ReturnFromDAO.avb"
'#include "HL74_Errors.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFrom(Op, 2, 1, 3, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If Not Workarea.Map("OpTagEval") Then Exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {879051AF-D1EE-11D5-8141-0002440B6A16}}
  op.SetFolder {guid {1170FBCF-3A97-4E23-8B5C-7E67059A125B}}
  op.Name = "Товары. Возврат поставщику. Возврат товара поставщику"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(3).SetAccDb {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, "Д.Б."
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H39
  op.TransList(4).LockUI &amp;H39
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Объекты учета--
  op.CopyEntities 3, 1
  op.CopyEntities 4, 1
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, True
  op.CopyAgents 3, True, 1, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=$1"
  op.TransList(4).CalcSum "=$2"
  '}} END_RECALC
End Sub
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:45:44 PM"/>
					</parameters>
				</template>
			</template>
		</template>
		<template GUID="{guid {34BB6A37-533F-4FA2-8260-2F041795F2EA}}" ID="1854" Memo="" Name="Магазин" Tag="" Type="0" FormID="0" FormGUID="" Script="'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:59:19
'= Автор  : admin
'==============================================

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 809
  op.Name = &quot;Магазин. Акт переоценки товара&quot;
  '--Счета--
  op.TransList(1).SetAccDb 69
  op.TransList(1).SetAccCr 69
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  op.TransList(3).SetAccDb 415
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 415
  '}} END_APPLY
End Sub

Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  '}} END_EDIT
End Sub

Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 1, False
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, False
  op.CopyAgents 4, False, 1, False
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 2, True, 1, True, True
  op.CopyAgents 3, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T3&quot;
  '}} END_RECALC
End Sub
'#include &quot;HL74_ReturnToRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:47:39
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 810
  op.SetFolder 554
  op.Name = &quot;Магазин. Возврат товара от покупателя&quot;
  '--Счета--
  op.TransList(1).SetAccDb 337
  op.TransList(1).SetAccCr 220
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 196
  op.TransList(3).SetAccDb 199
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 337
  op.TransList(5).SetAccDb 368
  op.TransList(5).SetAccCr 402
  '--Корреспонденты--
  op.TransList(4).SetAgMCTo
  op.TransList(5).SetAgMCTo
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H11
  op.TransList(5).LockUI &amp;H11
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 5, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  op.TransList(4).CalcSum &quot;=T1&quot;
  op.TransList(5).CalcSum &quot;=T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnToRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include &quot;HL74_ReturnFromRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:49:52
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = 811
  op.SetFolder 555
  op.Name = &quot;Магазин. Возврат товара поставщику&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFromRetail(Op, 1, 1, 3, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include &quot;HL74_RemoveToRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:52:13
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = 812
  op.SetFolder 557
  op.Name = &quot;Магазин. Перемещения товара. Перемещение из опта в розницу&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 195
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  op.TransList(3).SetAccDb 196
  op.TransList(3).SetAccCr 404
  '--Объекты учета--
  op.TransList(3).SetEnt 978
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H8
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 2, True, 1, False, True
  op.CopyAgents 3, False, 1, False, True
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = RemoveToRetail(Op, 1, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include &quot;HL74_RemoveToWholesaleDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:55:34
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = 813
  op.SetFolder 558
  op.Name = &quot;Магазин. Перемещения товара. Розница-&gt;Опт&quot;
  '--Счета--
  op.TransList(1).SetAccDb 195
  op.TransList(1).SetAccCr 196
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, True, True
  op.CopyAgents 2, True, 1, True, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = RemoveToWholesale(Op, 1, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include &quot;HL74_InternalMovingRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:56:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = 814
  op.SetFolder 559
  op.Name = &quot;Магазин. Перемещения товара. Розница-&gt;Розница&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 196
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = InternalMovingRetail(Op, 1, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include &quot;HL74_MakeSeriesRetailDAO.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:34:40
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = 808
  op.Name = &quot;Магазин. Поступление товара. Поступление товара от поставщика&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 299
  op.TransList(3).SetAccDb 196
  op.TransList(3).SetAccCr 199
  '--Объекты учета--
  op.TransList(2).SetEnt 978
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeriesRetail(Op, 1, 3)
  '}} END_BEFORESAVE
End Sub
'#include &quot;HL74_ChargeRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:42:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 815
  op.SetFolder 553
  op.Name = &quot;Магазин. Реализация товара. Реализация товаар за наличный расчет&quot;
  '--Счета--
  op.TransList(1).SetAccDb 201
  op.TransList(1).SetAccCr 335
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 196
  op.TransList(3).SetAccDb 199
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  op.TransList(5).SetAccDb 335
  op.TransList(5).SetAccCr 368
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 2, True, True
  op.CopyAgents 3, True, 2, True, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  op.CopyAgents 5, False, 1, True
  op.CopyAgents 5, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T2&quot;
  op.TransList(5).CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOffRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:59:19
'= Автор  : admin
'==============================================

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {73A81AC5-A51D-49FB-AE50-5DF7768051BE}}
  op.Name = "Магазин. Акт переоценки товара"
  '--Счета--
  op.TransList(1).SetAccDb {guid {D7ACAED9-296D-11D3-A02D-0080480180F7}}
  op.TransList(1).SetAccCr {guid {D7ACAED9-296D-11D3-A02D-0080480180F7}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccDb {guid {710C344D-58DB-4048-8461-6446B2B40B60}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {710C344D-58DB-4048-8461-6446B2B40B60}}
  '}} END_APPLY
End Sub

Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  '}} END_EDIT
End Sub

Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 1, False
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, False
  op.CopyAgents 4, False, 1, False
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 2, True, 1, True, True
  op.CopyAgents 3, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(4).CalcSum "=T3"
  '}} END_RECALC
End Sub
'#include "HL74_ReturnToRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:47:39
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {188DD830-0746-49FB-8109-B87A5757AFAC}}
  op.SetFolder {guid {5FEB07B6-31BB-4D5B-8438-5F0EB3876B8E}}
  op.Name = "Магазин. Возврат товара от покупателя"
  '--Счета--
  op.TransList(1).SetAccDb {guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}
  op.TransList(1).SetAccCr {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccDb {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}
  op.TransList(5).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(5).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  '--Корреспонденты--
  op.TransList(4).SetAgMCTo
  op.TransList(5).SetAgMCTo
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H11
  op.TransList(5).LockUI &amp;H11
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 5, True, 1, False
  '--Суммы--
  op.CalcSum "=T1+T2"
  op.TransList(4).CalcSum "=T1"
  op.TransList(5).CalcSum "=T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnToRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include "HL74_ReturnFromRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:49:52
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = {guid {BC642D70-9FE5-42BF-9B05-4C0ABEBD4620}}
  op.SetFolder {guid {7A1DD19A-0D95-440B-923C-49EEB600DA84}}
  op.Name = "Магазин. Возврат товара поставщику"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFromRetail(Op, 1, 1, 3, FALSE, TRUE, FALSE, FALSE, "", 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include "HL74_RemoveToRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:52:13
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = {guid {E27BF6A8-4664-41CB-97B8-C79F7C15B05A}}
  op.SetFolder {guid {21A5258C-4401-4A8D-AE71-BEB30BD63C90}}
  op.Name = "Магазин. Перемещения товара. Перемещение из опта в розницу"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccCr {guid {7743B5E5-D91A-4B47-B335-65711CD1F1D3}}
  '--Объекты учета--
  op.TransList(3).SetEnt {guid {AE42A48B-2A0F-4AE6-A007-C380045ED537}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H8
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 2, True, 1, False, True
  op.CopyAgents 3, False, 1, False, True
  '--Суммы--
  op.CalcSum "=T1+T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = RemoveToRetail(Op, 1, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include "HL74_RemoveToWholesaleDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:55:34
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = {guid {1D6EACDB-62BD-4429-80E0-1B1085D97FB7}}
  op.SetFolder {guid {058ED9A5-26D7-4A86-8CA1-74E9168AD6AE}}
  op.Name = "Магазин. Перемещения товара. Розница-&gt;Опт"
  '--Счета--
  op.TransList(1).SetAccDb {guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}
  op.TransList(1).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, True, True
  op.CopyAgents 2, True, 1, True, True
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = RemoveToWholesale(Op, 1, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include "HL74_InternalMovingRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:56:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = {guid {C0763A14-1EB5-4E62-9B11-E7E738B6CB97}}
  op.SetFolder {guid {EB52BA67-6A46-4F8E-BFFF-A1880F74D5D1}}
  op.Name = "Магазин. Перемещения товара. Розница-&gt;Розница"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = InternalMovingRetail(Op, 1, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub
'#include "HL74_MakeSeriesRetailDAO.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:34:40
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = {guid {C1F79DC1-DA3F-4CC2-B16A-36C9B8B7702D}}
  op.Name = "Магазин. Поступление товара. Поступление товара от поставщика"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(3).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '--Объекты учета--
  op.TransList(2).SetEnt {guid {AE42A48B-2A0F-4AE6-A007-C380045ED537}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  '--Суммы--
  op.CalcSum "=T1+T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeriesRetail(Op, 1, 3)
  '}} END_BEFORESAVE
End Sub
'#include "HL74_ChargeRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:42:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {7094D5C1-1AB2-48E5-8D34-C4CDEFF85B1D}}
  op.SetFolder {guid {C963C924-ED0B-4948-ABAD-E946EA67404F}}
  op.Name = "Магазин. Реализация товара. Реализация товаар за наличный расчет"
  '--Счета--
  op.TransList(1).SetAccDb {guid {CCEBE0A5-5FD6-4E6B-82EC-D3BA9E55E2D9}}
  op.TransList(1).SetAccCr {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccDb {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(5).SetAccDb {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(5).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 2, True, True
  op.CopyAgents 3, True, 2, True, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  op.CopyAgents 5, False, 1, True
  op.CopyAgents 5, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(4).CalcSum "=T2"
  op.TransList(5).CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOffRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

			<template GUID="{guid {3455822D-1D38-4720-A4D6-D81662EC9829}}" ID="1857" Memo="" Name="Магазин. Возврат товара от покупателя" Tag="" Type="0" FormID="0" FormGUID="" Script="'#include &quot;HL74_ReturnToRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:47:39
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 810
  op.SetFolder 554
  op.Name = &quot;Магазин. Возврат товара от покупателя&quot;
  '--Счета--
  op.TransList(1).SetAccDb 337
  op.TransList(1).SetAccCr 220
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 196
  op.TransList(3).SetAccDb 199
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 337
  op.TransList(5).SetAccDb 368
  op.TransList(5).SetAccCr 402
  '--Корреспонденты--
  op.TransList(4).SetAgMCTo
  op.TransList(5).SetAgMCTo
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H11
  op.TransList(5).LockUI &amp;H11
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 5, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  op.TransList(4).CalcSum &quot;=T1&quot;
  op.TransList(5).CalcSum &quot;=T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnToRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_ReturnToRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:47:39
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {188DD830-0746-49FB-8109-B87A5757AFAC}}
  op.SetFolder {guid {5FEB07B6-31BB-4D5B-8438-5F0EB3876B8E}}
  op.Name = "Магазин. Возврат товара от покупателя"
  '--Счета--
  op.TransList(1).SetAccDb {guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}
  op.TransList(1).SetAccCr {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccDb {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}
  op.TransList(5).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(5).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  '--Корреспонденты--
  op.TransList(4).SetAgMCTo
  op.TransList(5).SetAgMCTo
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H11
  op.TransList(5).LockUI &amp;H11
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 5, True, 1, False
  '--Суммы--
  op.CalcSum "=T1+T2"
  op.TransList(4).CalcSum "=T1"
  op.TransList(5).CalcSum "=T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnToRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

				<template GUID="{guid {50344DF5-5A26-46AD-B8FF-23F47102612C}}" ID="1858" Memo="" Name="Магазин. Возврат товара от покупателя" Tag="" Type="1" FormID="810" FormGUID="{guid {188DD830-0746-49FB-8109-B87A5757AFAC}}" Script="'#include &quot;HL74_ReturnToRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:47:39
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 810
  op.SetFolder 554
  op.Name = &quot;Магазин. Возврат товара от покупателя&quot;
  '--Счета--
  op.TransList(1).SetAccDb 337
  op.TransList(1).SetAccCr 220
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 196
  op.TransList(3).SetAccDb 199
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 337
  op.TransList(5).SetAccDb 368
  op.TransList(5).SetAccCr 402
  '--Корреспонденты--
  op.TransList(4).SetAgMCTo
  op.TransList(5).SetAgMCTo
  '--Разное--
  op.TransList(1).SetMisc 13, 159
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H11
  op.TransList(5).LockUI &amp;H11
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 2, True
  op.CopyAgents 2, False, 1, True, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 5, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  op.TransList(4).CalcSum &quot;=T1&quot;
  op.TransList(5).CalcSum &quot;=T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnToRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_ReturnToRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:47:39
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {188DD830-0746-49FB-8109-B87A5757AFAC}}
  op.SetFolder {guid {5FEB07B6-31BB-4D5B-8438-5F0EB3876B8E}}
  op.Name = "Магазин. Возврат товара от покупателя"
  '--Счета--
  op.TransList(1).SetAccDb {guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}
  op.TransList(1).SetAccCr {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccDb {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}
  op.TransList(5).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(5).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  '--Корреспонденты--
  op.TransList(4).SetAgMCTo
  op.TransList(5).SetAgMCTo
  '--Разное--
  op.TransList(1).SetMisc 13, {guid {E07C5D68-C67F-45E2-8067-D49510A07960}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H8
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H11
  op.TransList(5).LockUI &amp;H11
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, False, 2, True
  op.CopyAgents 2, False, 1, True, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, True, 1, False
  op.CopyAgents 5, True, 1, False
  '--Суммы--
  op.CalcSum "=T1+T2"
  op.TransList(4).CalcSum "=T1"
  op.TransList(5).CalcSum "=T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnToRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:44:25 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {9340FEA2-01C1-48C2-B1AB-BF194EDD9A1D}}" ID="1859" Memo="" Name="Магазин. Возврат товара поставщику" Tag="" Type="0" FormID="0" FormGUID="" Script="'#include &quot;HL74_ReturnFromRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:49:52
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = 811
  op.SetFolder 555
  op.Name = &quot;Магазин. Возврат товара поставщику&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFromRetail(Op, 1, 1, 3, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_ReturnFromRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:49:52
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = {guid {BC642D70-9FE5-42BF-9B05-4C0ABEBD4620}}
  op.SetFolder {guid {7A1DD19A-0D95-440B-923C-49EEB600DA84}}
  op.Name = "Магазин. Возврат товара поставщику"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFromRetail(Op, 1, 1, 3, FALSE, TRUE, FALSE, FALSE, "", 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

				<template GUID="{guid {B433E27C-B6E0-4D85-92B7-B72239754019}}" ID="1860" Memo="" Name="Магазин. Возврат товара поставщику" Tag="" Type="1" FormID="811" FormGUID="{guid {BC642D70-9FE5-42BF-9B05-4C0ABEBD4620}}" Script="'#include &quot;HL74_ReturnFromRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:49:52
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = 811
  op.SetFolder 555
  op.Name = &quot;Магазин. Возврат товара поставщику&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 199
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, &quot;Д.Б.&quot;
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFromRetail(Op, 1, 1, 3, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_ReturnFromRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:49:52
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 2
  '--Общие--
  op.FormID = {guid {BC642D70-9FE5-42BF-9B05-4C0ABEBD4620}}
  op.SetFolder {guid {7A1DD19A-0D95-440B-923C-49EEB600DA84}}
  op.Name = "Магазин. Возврат товара поставщику"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, "Д.Б."
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 2
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, False
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ReturnFromRetail(Op, 1, 1, 3, FALSE, TRUE, FALSE, FALSE, "", 1, 2)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:44:38 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {D5A8450B-6330-4813-8F4E-3D19548A3514}}" ID="1865" Memo="" Name="Магазин. Поступление товара" Tag="" Type="0" FormID="0" FormGUID="" Script="'#include &quot;HL74_MakeSeriesRetailDAO.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:34:40
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = 808
  op.Name = &quot;Магазин. Поступление товара. Поступление товара от поставщика&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 299
  op.TransList(3).SetAccDb 196
  op.TransList(3).SetAccCr 199
  '--Объекты учета--
  op.TransList(2).SetEnt 978
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeriesRetail(Op, 1, 3)
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_MakeSeriesRetailDAO.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:34:40
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 3
  '--Общие--
  op.FormID = {guid {C1F79DC1-DA3F-4CC2-B16A-36C9B8B7702D}}
  op.Name = "Магазин. Поступление товара. Поступление товара от поставщика"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(3).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '--Объекты учета--
  op.TransList(2).SetEnt {guid {AE42A48B-2A0F-4AE6-A007-C380045ED537}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 3
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  '--Суммы--
  op.CalcSum "=T1+T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeriesRetail(Op, 1, 3)
  '}} END_BEFORESAVE
End Sub

				<template GUID="{guid {E1615040-73C0-44DD-8711-FCE139BE2BC8}}" ID="1866" Memo="" Name="Магазин. Поступление товара. Поступление товара от поставщика" Tag="" Type="1" FormID="808" FormGUID="{guid {C1F79DC1-DA3F-4CC2-B16A-36C9B8B7702D}}" Script="'#include &quot;HL74_MakeSeriesRetailDAO.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:34:40
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 808
  op.Name = &quot;Магазин. Поступление товара. Поступление товара от поставщика&quot;
  '--Счета--
  op.TransList(1).SetAccDb 196
  op.TransList(1).SetAccCr 299
  op.TransList(2).SetAccDb 196
  op.TransList(2).SetAccCr 299
  op.TransList(3).SetAccDb 196
  op.TransList(3).SetAccCr 199
  op.TransList(4).SetAccDb 196
  op.TransList(4).SetAccCr 199
  '--Объекты учета--
  op.TransList(2).SetEnt 978
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, &quot;Д.Б.&quot;
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, False, 1, False
  op.CopyAgents 4, True, 1, False
  '--Суммы--
  op.CalcSum &quot;=T1+T2&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeriesRetail(Op, 1, 3)
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_MakeSeriesRetailDAO.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:34:40
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {C1F79DC1-DA3F-4CC2-B16A-36C9B8B7702D}}
  op.Name = "Магазин. Поступление товара. Поступление товара от поставщика"
  '--Счета--
  op.TransList(1).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(2).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(2).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  op.TransList(3).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(4).SetAccDb {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccCr {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  '--Объекты учета--
  op.TransList(2).SetEnt {guid {AE42A48B-2A0F-4AE6-A007-C380045ED537}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, "Д.Б."
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H18
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H18
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 2, False, 1, False
  op.CopyAgents 2, True, 1, True
  op.CopyAgents 3, False, 1, False, True
  op.CopyAgents 3, True, 1, False, True
  op.CopyAgents 4, False, 1, False
  op.CopyAgents 4, True, 1, False
  '--Суммы--
  op.CalcSum "=T1+T2"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeriesRetail(Op, 1, 3)
  '}} END_BEFORESAVE
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:44:50 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {1175B9CF-5473-4134-B3C0-6C64A7E744CF}}" ID="1867" Memo="" Name="Магазин. Реализация товара" Tag="" Type="0" FormID="0" FormGUID="" Script="'#include &quot;HL74_ChargeRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:42:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 815
  op.SetFolder 553
  op.Name = &quot;Магазин. Реализация товара. Реализация товаар за наличный расчет&quot;
  '--Счета--
  op.TransList(1).SetAccDb 201
  op.TransList(1).SetAccCr 335
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 196
  op.TransList(3).SetAccDb 199
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  op.TransList(5).SetAccDb 335
  op.TransList(5).SetAccCr 368
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 2, True, True
  op.CopyAgents 3, True, 2, True, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  op.CopyAgents 5, False, 1, True
  op.CopyAgents 5, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T2&quot;
  op.TransList(5).CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOffRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_ChargeRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:42:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {7094D5C1-1AB2-48E5-8D34-C4CDEFF85B1D}}
  op.SetFolder {guid {C963C924-ED0B-4948-ABAD-E946EA67404F}}
  op.Name = "Магазин. Реализация товара. Реализация товаар за наличный расчет"
  '--Счета--
  op.TransList(1).SetAccDb {guid {CCEBE0A5-5FD6-4E6B-82EC-D3BA9E55E2D9}}
  op.TransList(1).SetAccCr {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccDb {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(5).SetAccDb {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(5).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 2, True, True
  op.CopyAgents 3, True, 2, True, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  op.CopyAgents 5, False, 1, True
  op.CopyAgents 5, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(4).CalcSum "=T2"
  op.TransList(5).CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOffRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

				<template GUID="{guid {1C540293-51A0-48DE-92C7-6D8351891456}}" ID="1868" Memo="" Name="Магазин. Реализация товара. Реализация товаар за наличный расчет" Tag="" Type="1" FormID="815" FormGUID="{guid {7094D5C1-1AB2-48E5-8D34-C4CDEFF85B1D}}" Script="'#include &quot;HL74_ChargeRetailDAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:42:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = 815
  op.SetFolder 553
  op.Name = &quot;Магазин. Реализация товара. Реализация товаар за наличный расчет&quot;
  '--Счета--
  op.TransList(1).SetAccDb 201
  op.TransList(1).SetAccCr 335
  op.TransList(2).SetAccDb 402
  op.TransList(2).SetAccCr 196
  op.TransList(3).SetAccDb 199
  op.TransList(3).SetAccCr 196
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 402
  op.TransList(5).SetAccDb 335
  op.TransList(5).SetAccCr 368
  '--Разное--
  op.TransList(1).SetMisc 13, 159
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 2, True, True
  op.CopyAgents 3, True, 2, True, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  op.CopyAgents 5, False, 1, True
  op.CopyAgents 5, True, 1, True
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T2&quot;
  op.TransList(5).CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOffRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

">'#include "HL74_ChargeRetailDAO.avb"
'#include "HL74_Errors.avb"
'==============================================
'= Акцент 7.4 
'= Создан : 12/09/2015 19:42:22
'= Автор  : admin
'==============================================
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 5
  '--Общие--
  op.FormID = {guid {7094D5C1-1AB2-48E5-8D34-C4CDEFF85B1D}}
  op.SetFolder {guid {C963C924-ED0B-4948-ABAD-E946EA67404F}}
  op.Name = "Магазин. Реализация товара. Реализация товаар за наличный расчет"
  '--Счета--
  op.TransList(1).SetAccDb {guid {CCEBE0A5-5FD6-4E6B-82EC-D3BA9E55E2D9}}
  op.TransList(1).SetAccCr {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(2).SetAccDb {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(2).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(3).SetAccDb {guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}
  op.TransList(3).SetAccCr {guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}
  op.TransList(5).SetAccDb {guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}
  op.TransList(5).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  '--Разное--
  op.TransList(1).SetMisc 13, {guid {E07C5D68-C67F-45E2-8067-D49510A07960}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 5
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(1).LockUI &amp;H10
  op.TransList(2).LockUI &amp;H8
  op.TransList(3).LockUI &amp;H18
  op.TransList(4).LockUI &amp;H19
  op.TransList(5).LockUI &amp;H19
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Корреспонденты--
  op.CopyAgents 1, True, 2, True
  op.CopyAgents 2, False, 1, False, True
  op.CopyAgents 3, False, 2, True, True
  op.CopyAgents 3, True, 2, True, True
  op.CopyAgents 4, False, 1, True
  op.CopyAgents 4, True, 1, True
  op.CopyAgents 5, False, 1, True
  op.CopyAgents 5, True, 1, True
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(4).CalcSum "=T2"
  op.TransList(5).CalcSum "=T1"
  '}} END_RECALC
End Sub
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOffRetail(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1, 3)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:40:46 PM"/>
					</parameters>
				</template>
			</template>
		</template>
		<template GUID="{guid {BA02769E-23BF-42F7-B719-5CDABD0EDDE8}}" ID="1740" Memo="" Name="Материалы" Tag="" Type="0" FormID="0" FormGUID="" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 361
  op.Name = &quot;Материалы. Реализация. Реализация материалов покупателю&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 340
  op.TransList(2).SetAccDb 412
  op.TransList(2).SetAccCr 168
  op.TransList(3).SetAccDb 347
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 412
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T3&quot;
  '}} END_RECALC
End Sub

">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {30888950-1A18-11D6-8142-0002440B6A16}}
  op.Name = "Материалы. Реализация. Реализация материалов покупателю"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {1AED0F61-E203-4DCE-BAE7-DD2FA05300F6}}
  op.TransList(2).SetAccDb {guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}
  op.TransList(2).SetAccCr {guid {4D330E66-9F63-48D3-9557-5F1353A1287A}}
  op.TransList(3).SetAccDb {guid {4C5C7A3F-3A7A-4595-B643-771C847F6172}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=T1"
  op.TransList(4).CalcSum "=T3"
  '}} END_RECALC
End Sub

			<template GUID="{guid {D1BDF31B-F007-42BF-A908-837EAC820CE7}}" ID="1746" Memo="" Name="Материалы. Поступление" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {4A7B00A1-5F34-440F-A746-FE6270DD7DA8}}" ID="1802" Memo="" Name="Материалы. Поступление. Поступление материалов от поставщика" Tag="" Type="1" FormID="705" FormGUID="{guid {3FC0F86E-9FF9-4C9C-A94F-8B5D8C42740C}}" Script="'#include &quot;HL74_MakeSeries2DAO.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeries2(Op, 1)
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 705
  op.Name = &quot;Материалы. Поступление. Поступление материалов от поставщика&quot;
  '--Счета--
  op.TransList(1).SetAccDb 168
  op.TransList(1).SetAccCr 299
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, &quot;Д.Б.&quot;
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub
">'#include "HL74_MakeSeries2DAO.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	Call MakeSeries2(Op, 1)
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {3FC0F86E-9FF9-4C9C-A94F-8B5D8C42740C}}
  op.Name = "Материалы. Поступление. Поступление материалов от поставщика"
  '--Счета--
  op.TransList(1).SetAccDb {guid {4D330E66-9F63-48D3-9557-5F1353A1287A}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-Б, "Д.Б."
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:45:06 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {6775299C-D3DE-4D3C-B51E-8C1C3D416EBD}}" ID="1748" Memo="" Name="Материалы. Реализация" Tag="" Type="0" FormID="0" FormGUID="" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 361
  op.Name = &quot;Материалы. Реализация. Реализация материалов покупателю&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 340
  op.TransList(2).SetAccDb 412
  op.TransList(2).SetAccCr 168
  op.TransList(3).SetAccDb 347
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 412
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T3&quot;
  '}} END_RECALC
End Sub

">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {30888950-1A18-11D6-8142-0002440B6A16}}
  op.Name = "Материалы. Реализация. Реализация материалов покупателю"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {1AED0F61-E203-4DCE-BAE7-DD2FA05300F6}}
  op.TransList(2).SetAccDb {guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}
  op.TransList(2).SetAccCr {guid {4D330E66-9F63-48D3-9557-5F1353A1287A}}
  op.TransList(3).SetAccDb {guid {4C5C7A3F-3A7A-4595-B643-771C847F6172}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=T1"
  op.TransList(4).CalcSum "=T3"
  '}} END_RECALC
End Sub

				<template GUID="{guid {438D97A4-553B-429E-8EE4-8EC921FB3280}}" ID="1803" Memo="" Name="Материалы. Реализация. Реализация материалов покупателю" Tag="" Type="1" FormID="361" FormGUID="{guid {30888950-1A18-11D6-8142-0002440B6A16}}" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 361
  op.Name = &quot;Материалы. Реализация. Реализация материалов покупателю&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 340
  op.TransList(2).SetAccDb 412
  op.TransList(2).SetAccCr 168
  op.TransList(3).SetAccDb 347
  op.TransList(3).SetAccCr 368
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 412
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(3).CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T3&quot;
  '}} END_RECALC
End Sub

">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 2, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {30888950-1A18-11D6-8142-0002440B6A16}}
  op.Name = "Материалы. Реализация. Реализация материалов покупателю"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {1AED0F61-E203-4DCE-BAE7-DD2FA05300F6}}
  op.TransList(2).SetAccDb {guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}
  op.TransList(2).SetAccCr {guid {4D330E66-9F63-48D3-9557-5F1353A1287A}}
  op.TransList(3).SetAccDb {guid {4C5C7A3F-3A7A-4595-B643-771C847F6172}}
  op.TransList(3).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(3).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(3).CalcSum "=T1"
  op.TransList(4).CalcSum "=T3"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:41:15 PM"/>
					</parameters>
				</template>
			</template>
		</template>
		<template GUID="{guid {CE059B59-4AEC-4AD5-B0A2-17703E1A8F35}}" ID="1763" Memo="" Name="Производство" Tag="" Type="0" FormID="0" FormGUID="" Script="">
			<template GUID="{guid {6190C940-6022-428F-8508-A37C8041889E}}" ID="1764" Memo="" Name="Производство. Реализация" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {45EB470B-DABF-442C-B933-E3143B2EA7BD}}" ID="1765" Memo="" Name="Производство. Реализация собственной продукции" Tag="" Type="1" FormID="320" FormGUID="{guid {87905063-D1EE-11D5-8141-0002440B6A16}}" Script="'#include &quot;HL74_Charge2DAO.avb&quot;
'#include &quot;HL74_Errors.avb&quot;
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 3, 1, 1, FALSE, TRUE, FALSE, FALSE, &quot;&quot;, 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = 320
  op.SetFolder 535
  op.Name = &quot;Производство. Реализация собственной продукции&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 336
  op.TransList(2).SetAccDb 334
  op.TransList(2).SetAccCr 368
  op.TransList(3).SetAccDb 401
  op.TransList(3).SetAccCr 192
  op.TransList(4).SetAccDb 368
  op.TransList(4).SetAccCr 401
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  op.TransList(2).CalcSum &quot;=T1&quot;
  op.TransList(4).CalcSum &quot;=T3&quot;
  '}} END_RECALC
End Sub
">'#include "HL74_Charge2DAO.avb"
'#include "HL74_Errors.avb"
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
	If Op.Done then Op.Done = ChargeOff3(Op, 3, 1, 1, FALSE, TRUE, FALSE, FALSE, "", 1)
	Op.TemplateInvoker.FireOnRecalc
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub
Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 4
  '--Общие--
  op.FormID = {guid {87905063-D1EE-11D5-8141-0002440B6A16}}
  op.SetFolder {guid {86704DC4-ACA1-4ECE-BBCC-1CD235A0048E}}
  op.Name = "Производство. Реализация собственной продукции"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {4D5AF790-5BFC-4D01-B460-66B92FA3245E}}
  op.TransList(2).SetAccDb {guid {F9EBE1A8-FDD4-4027-9EE3-E86B9C556F0C}}
  op.TransList(2).SetAccCr {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(3).SetAccDb {guid {F699D66F-A0C6-4AB9-A716-24BFD71CF3AF}}
  op.TransList(3).SetAccCr {guid {6F558117-38C2-4F73-9DB0-554F8390D576}}
  op.TransList(4).SetAccDb {guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}
  op.TransList(4).SetAccCr {guid {F699D66F-A0C6-4AB9-A716-24BFD71CF3AF}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub
Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 4
  op.LockUI &amp;H9
  '--Блокировки--
  op.TransList(2).LockUI &amp;H1
  op.TransList(4).LockUI &amp;H1
  '}} END_EDIT
End Sub
Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  op.TransList(2).CalcSum "=T1"
  op.TransList(4).CalcSum "=T3"
  '}} END_RECALC
End Sub
					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:41:44 PM"/>
					</parameters>
				</template>
			</template>
		</template>
		<template GUID="{guid {D0283847-92F2-4004-BB20-C1EDC8CA3C79}}" ID="1757" Memo="" Name="Услуги" Tag="" Type="0" FormID="0" FormGUID="" Script="">
			<template GUID="{guid {E0698378-F789-4E93-94CD-6D5F8E381427}}" ID="1758" Memo="" Name="Услуги. Оказанные" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {5B158A4F-D27D-4546-BBCA-D3C5BBDCB841}}" ID="1767" Memo="" Name="Услуги. Услуги, оказанные по аренде" Tag="" Type="1" FormID="308" FormGUID="{guid {5217F1AF-D1D0-11D5-8141-0002440B6A16}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 308
  op.Name = &quot;Услуги. Услуги, оказанные по аренде&quot;
  '--Счета--
  op.TransList(1).SetAccDb 220
  op.TransList(1).SetAccCr 336
  '--Разное--
  op.TransList(1).SetMisc 13, 164
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {5217F1AF-D1D0-11D5-8141-0002440B6A16}}
  op.Name = "Услуги. Услуги, оказанные по аренде"
  '--Счета--
  op.TransList(1).SetAccDb {guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}
  op.TransList(1).SetAccCr {guid {4D5AF790-5BFC-4D01-B460-66B92FA3245E}}
  '--Разное--
  op.TransList(1).SetMisc 13, {guid {0E8BE948-738A-4CF2-852C-008421F15F1A}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:37:37 PM"/>
					</parameters>
				</template>
			</template>
			<template GUID="{guid {2F3ED419-CC75-469B-9584-3A01F054458F}}" ID="1759" Memo="" Name="Услуги. Полученные" Tag="" Type="0" FormID="0" FormGUID="" Script="">
				<template GUID="{guid {3441FCF2-4199-455F-8509-1A5BA2EACF50}}" ID="1811" Memo="" Name="Услуги. Услуги, полученные по аренде" Tag="" Type="1" FormID="704" FormGUID="{guid {89183A36-C534-4F92-9454-5343D14FDDC2}}" Script="
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map(&quot;OpTagEval&quot;) then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; &quot;&quot; Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = 704
  op.Name = &quot;Услуги. Услуги, полученные по аренде&quot;
  '--Счета--
  op.TransList(1).SetAccDb 405
  op.TransList(1).SetAccCr 299
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, &quot;Д.А.&quot;
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum &quot;=T1&quot;
  '}} END_RECALC
End Sub

">
Sub TEMPLATE_BEFORESAVE(OP, ByRef CANCEL)
  '{{ BEGIN_BEFORESAVE
  '}} END_BEFORESAVE
	If not Workarea.Map("OpTagEval") then exit Sub
 	With Workarea.Template(Op.TemplateID)
		If .Memo &lt;&gt; "" Then Op.Tag = Eval(.Memo)
 	End With
End Sub

Sub Template_OnApply(op)
  '{{ BEGIN_APPLY
  '--Число проводок--
  op.TransCount = 1
  '--Общие--
  op.FormID = {guid {89183A36-C534-4F92-9454-5343D14FDDC2}}
  op.Name = "Услуги. Услуги, полученные по аренде"
  '--Счета--
  op.TransList(1).SetAccDb {guid {80E7AFB0-8DA5-4A14-98A8-13781451F3AE}}
  op.TransList(1).SetAccCr {guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}
  '--Налоговые отчеты--
  op.TransList(1).settax ДПУ-А, "Д.А."
  '}} END_APPLY
End Sub


Sub Template_OnEdit(op)
  '{{ BEGIN_EDIT
  '--Число проводок--
  op.TransCount = 1
  op.LockUI &amp;H9
  '}} END_EDIT
End Sub


Sub Template_OnRecalc(op)
  '{{ BEGIN_RECALC
  '--Суммы--
  op.CalcSum "=T1"
  '}} END_RECALC
End Sub

					<parameters>
						<parameter Name="Изменен" Type="7" RefKind="0" Value2="7/5/2016 5:38:43 PM"/>
					</parameters>
				</template>
			</template>
		</template>
	</AccentTemplates>
	<AccentEntities>
		<entity ID="385" GUID="{guid {5217F0F5-D1D0-11D5-8141-0002440B6A16}}" Art="" Bar="" Cat="" Name="Товары" Nom="" Tag="SYS385" Type="0" Memo="" UnSelf="True" UnitID="1">
			<entity ID="977" GUID="{guid {3B3CD85D-D40E-4498-9573-9F6086B0E60F}}" Art="" Bar="" Cat="" Name="ТЗР" Nom="" Tag="" Type="0" Memo="" UnSelf="False" UnitID="0">
				<entity ID="978" GUID="{guid {AE42A48B-2A0F-4AE6-A007-C380045ED537}}" Art="" Bar="" Cat="" Name="Товар-транспортные затраты" Nom="" Tag="" Type="1001" Memo="" UnSelf="False" UnitID="0"/>
			</entity>
		</entity>
	</AccentEntities>
	<AccentMiscs>
		<misc ID="157" GUID="{guid {8EBAF842-4FF0-4AB5-A7C8-49B97BEE8DC3}}" Date1="12:00:00 AM" Date2="12:00:00 AM" Date3="12:00:00 AM" Long1="0" Long2="0" Long3="0" Memo="" MscNo="13" Name="Торговое оборудование" RefFolderID="0" RefKind="0" String1="" String2="" String3="" Sum1="0" Sum2="0" Sum3="0" Tag="" Type="-1">
			<misc ID="158" GUID="{guid {EA766689-8B93-4BCC-9999-CA573FE816F7}}" Date1="12:00:00 AM" Date2="12:00:00 AM" Date3="12:00:00 AM" Long1="0" Long2="0" Long3="0" Memo="" MscNo="13" Name="Кассовые регистраторы" RefFolderID="0" RefKind="0" String1="" String2="" String3="" Sum1="0" Sum2="0" Sum3="0" Tag="" Type="0">
				<misc ID="159" GUID="{guid {E07C5D68-C67F-45E2-8067-D49510A07960}}" Date1="12:00:00 AM" Date2="12:00:00 AM" Date3="12:00:00 AM" Long1="9600" Long2="0" Long3="0" Memo="" MscNo="13" Name="Меркурий 119Ф" RefFolderID="0" RefKind="0" String1="HL74_CashPrintM119F.avb" String2="1" String3="" Sum1="0" Sum2="0" Sum3="0" Tag="" Type="1"/>
			</misc>
			<misc ID="163" GUID="{guid {AA13977F-1D0E-4917-8332-AD350C8EEB59}}" Date1="12:00:00 AM" Date2="12:00:00 AM" Date3="12:00:00 AM" Long1="0" Long2="0" Long3="0" Memo="" MscNo="13" Name="Контрольно-кассовые аппараты" RefFolderID="0" RefKind="0" String1="" String2="" String3="" Sum1="0" Sum2="0" Sum3="0" Tag="" Type="0">
				<misc ID="164" GUID="{guid {0E8BE948-738A-4CF2-852C-008421F15F1A}}" Date1="12:00:00 AM" Date2="12:00:00 AM" Date3="12:00:00 AM" Long1="9600" Long2="195" Long3="1" Memo="" MscNo="13" Name="Меркурий 130Ф" RefFolderID="0" RefKind="0" String1="" String2="1" String3="C:\ProgramData\MercuryDriver\DATA" Sum1="0" Sum2="0" Sum3="0" Tag="ККМ_1" Type="1"/>
			</misc>
		</misc>
	</AccentMiscs>
	<AccentAgents/>
	<AccentBanks/>
	<AccentAccounts>
		<account ID="70" GUID="{guid {D7ACAE94-296D-11D3-A02D-0080480180F7}}" Code="A" Name="Основной план счетов" PlanID="70" SaldoType="0" Tag="SYS70" Type="-1" Memo="">
			<account ID="108" GUID="{guid {95B84271-0302-4612-8473-E9C13C41F8E3}}" Code="10" Name="Основные средства" PlanID="70" SaldoType="0" Tag="SYS108" Type="0" Memo="">
				<account ID="119" GUID="{guid {3EF66089-285E-4D7E-8542-C27EF451E6CC}}" Code="107" Name="Животные" PlanID="70" SaldoType="0" Tag="SYS119" Type="0" Memo="Счет изменен/добавлен системой обновления"/>
				<account ID="111" GUID="{guid {95D51555-0595-4C02-9423-6ABB83F2A099}}" Code="103" Name="Здания и сооружения" PlanID="70" SaldoType="0" Tag="SYS111" Type="0" Memo="">
					<account ID="112" GUID="{guid {89415486-6A7D-4A92-840D-67EA04653A7F}}" Code="1031" Name="Здания и сооружения на складе" PlanID="70" SaldoType="0" Tag="SYS112" Type="0" Memo=""/>
				</account>
				<account ID="113" GUID="{guid {649CB862-D2CD-4A99-98B3-76DB82505B52}}" Code="104" Name="Машины и оборудование" PlanID="70" SaldoType="0" Tag="SYS113" Type="0" Memo="">
					<account ID="114" GUID="{guid {C827DEC6-B862-4CE0-A8AD-63756B73ECD3}}" Code="1041" Name="Машины и оборудование на складе" PlanID="70" SaldoType="0" Tag="SYS114" Type="0" Memo=""/>
				</account>
				<account ID="115" GUID="{guid {BB7B1A2B-4D60-4609-B95D-AA7EA09A2046}}" Code="105" Name="Транспортные средства" PlanID="70" SaldoType="0" Tag="SYS115" Type="0" Memo="">
					<account ID="116" GUID="{guid {C8D7FF9E-FA12-4860-9BE1-66F3F3D70C3C}}" Code="1051" Name="Транспортные средства на складе" PlanID="70" SaldoType="0" Tag="SYS116" Type="0" Memo=""/>
				</account>
				<account ID="117" GUID="{guid {F417A3C9-D9E0-4081-885B-41544D563A02}}" Code="106" Name="Инструменты, приборы и инвентарь" PlanID="70" SaldoType="0" Tag="SYS117" Type="0" Memo="">
					<account ID="118" GUID="{guid {9539FF18-244F-4C7F-BDA2-A19409A56E8F}}" Code="1061" Name="Инструменты, приборы и инвентарь на складе" PlanID="70" SaldoType="0" Tag="SYS118" Type="0" Memo=""/>
				</account>
				<account ID="121" GUID="{guid {6FEC91A2-FBDC-4314-880F-D33F3A52AA0D}}" Code="109" Name="Прочие основные средства" PlanID="70" SaldoType="0" Tag="SYS121" Type="0" Memo="">
					<account ID="122" GUID="{guid {F4F85C89-8D88-4C6C-A412-05F8E5E83A0C}}" Code="1091" Name="Прочие ОС на складе" PlanID="70" SaldoType="0" Tag="SYS122" Type="0" Memo=""/>
				</account>
			</account>
			<account ID="404" GUID="{guid {7743B5E5-D91A-4B47-B335-65711CD1F1D3}}" Code="91" Name="Общепроизводственные расходы" PlanID="70" SaldoType="0" Tag="SYS404" Type="0" Memo=""/>
			<account ID="409" GUID="{guid {ED397C54-0A7A-438F-99A8-DEA0CB2FAE8E}}" Code="94" Name="Другие  расходы операционной деятельности" PlanID="70" SaldoType="0" Tag="SYS409" Type="1" Memo="">
				<account ID="415" GUID="{guid {710C344D-58DB-4048-8461-6446B2B40B60}}" Code="946" Name="Потери от обесценивания запасов" PlanID="70" SaldoType="0" Tag="SYS415" Type="1" Memo=""/>
				<account ID="412" GUID="{guid {7BD31E8E-2DA6-4F45-AD60-5642C4FAC29D}}" Code="943" Name="Себестоимость реализованных производственных запасов" PlanID="70" SaldoType="0" Tag="SYS412" Type="1" Memo=""/>
				<account ID="416" GUID="{guid {A939FC4C-2442-4A43-B22F-D6E4671233D5}}" Code="947" Name="Недостачи и потери от порчи ценностей" PlanID="70" SaldoType="0" Tag="SYS416" Type="1" Memo=""/>
			</account>
			<account ID="405" GUID="{guid {80E7AFB0-8DA5-4A14-98A8-13781451F3AE}}" Code="92" Name="Административные расходы" PlanID="70" SaldoType="0" Tag="SYS405" Type="0" Memo=""/>
			<account ID="563" GUID="{guid {66C31ABD-10C3-4395-80E4-FA7DA46516B3}}" Code="ТХ" Name="Технические забалансовые счета" PlanID="70" SaldoType="0" Tag="" Type="3" Memo="">
				<account ID="572" GUID="{guid {1D4F8450-AACB-409F-A654-9B36B9C35623}}" Code="ГТД" Name="Товаро транспортная наклданая (ГТД)" PlanID="70" SaldoType="0" Tag="" Type="3" Memo=""/>
				<account ID="570" GUID="{guid {B2B29ABE-47B4-4F15-A50E-A959E4F46D7E}}" Code="ТТН" Name="Товаро транспортная накладная" PlanID="70" SaldoType="0" Tag="" Type="3" Memo=""/>
			</account>
			<account ID="194" GUID="{guid {BB96D902-589B-43FA-807E-AA98A421C219}}" Code="28" Name="Товары" PlanID="70" SaldoType="0" Tag="SYS194" Type="0" Memo="">
				<account ID="197" GUID="{guid {0592227D-F1C6-4750-BED8-D634CB1FF52A}}" Code="283" Name="Товары на комиссии" PlanID="70" SaldoType="0" Tag="SYS197" Type="0" Memo=""/>
				<account ID="196" GUID="{guid {35C43AB9-E7C7-4A36-8356-7B6521D73F37}}" Code="282" Name="Товары в торговле" PlanID="70" SaldoType="0" Tag="SYS196" Type="0" Memo=""/>
				<account ID="199" GUID="{guid {60529DE0-EF3A-40AF-B454-76CCE389439F}}" Code="285" Name="Торговая наценка" PlanID="70" SaldoType="0" Tag="SYS199" Type="0" Memo=""/>
				<account ID="195" GUID="{guid {62FDA4D0-52B0-4951-A300-FB4EF8FD9A9E}}" Code="281" Name="Товары на складе" PlanID="70" SaldoType="0" Tag="SYS195" Type="0" Memo=""/>
			</account>
			<account ID="219" GUID="{guid {F9DF1002-FEF6-4CC4-A413-589731495FB5}}" Code="36" Name="Расчеты с покупателями и заказчиками" PlanID="70" SaldoType="0" Tag="SYS219" Type="0" Memo="">
				<account ID="562" GUID="{guid {AA575F00-FEBA-4EB8-A204-48BE4EEEADF1}}" Code="364" Name="Расчеты по комиссии" PlanID="70" SaldoType="0" Tag="" Type="0" Memo=""/>
				<account ID="220" GUID="{guid {6EC9A0F1-F594-4F49-B4B5-4D6D6165249E}}" Code="361" Name="Расчёты с отечественными покупателями" PlanID="70" SaldoType="0" Tag="SYS220" Type="1" Memo=""/>
			</account>
			<account ID="426" GUID="{guid {97471569-4457-4551-96DD-F7571287C297}}" Code="97" Name="Другие расходы" PlanID="70" SaldoType="0" Tag="SYS426" Type="1" Memo="">
				<account ID="559" GUID="{guid {803867A3-6BDA-4A64-A0BA-6812FA5515EC}}" Code="970" Name="Расходы от изменения стоимости финансовых инструментов" PlanID="70" SaldoType="0" Tag="SYS970" Type="0" Memo="изменения ПСБУ от 26.02.2014 г. № 341/25118"/>
			</account>
			<account ID="192" GUID="{guid {6F558117-38C2-4F73-9DB0-554F8390D576}}" Code="26" Name="Готовая продукция" PlanID="70" SaldoType="0" Tag="SYS192" Type="0" Memo=""/>
			<account ID="333" GUID="{guid {3E42980E-F227-4FFB-A33D-9067C82B9FB8}}" Code="70" Name="Доходы от реализации" PlanID="70" SaldoType="0" Tag="SYS333" Type="2" Memo="">
				<account ID="336" GUID="{guid {4D5AF790-5BFC-4D01-B460-66B92FA3245E}}" Code="703" Name="Доход от реализации работ и услуг" PlanID="70" SaldoType="0" Tag="SYS336" Type="1" Memo=""/>
				<account ID="334" GUID="{guid {F9EBE1A8-FDD4-4027-9EE3-E86B9C556F0C}}" Code="701" Name="Доход от реализации готовой продукции" PlanID="70" SaldoType="0" Tag="SYS334" Type="1" Memo=""/>
				<account ID="337" GUID="{guid {0076B3AB-58A6-47F8-9CCC-A12ACBC30808}}" Code="704" Name="Вычеты из дохода" PlanID="70" SaldoType="0" Tag="SYS337" Type="0" Memo=""/>
				<account ID="335" GUID="{guid {24DC5D32-C2AB-474B-BFC6-921D372BEF73}}" Code="702" Name="Доход от реализации товаров" PlanID="70" SaldoType="0" Tag="SYS335" Type="1" Memo=""/>
			</account>
			<account ID="400" GUID="{guid {1CE24D86-EC12-41AB-A839-484D38C59709}}" Code="90" Name="Себестоимость реализации" PlanID="70" SaldoType="0" Tag="SYS400" Type="1" Memo="">
				<account ID="401" GUID="{guid {F699D66F-A0C6-4AB9-A716-24BFD71CF3AF}}" Code="901" Name="Себестоимость реализованной готовой продукции" PlanID="70" SaldoType="0" Tag="SYS401" Type="1" Memo=""/>
				<account ID="402" GUID="{guid {5541E636-2BDB-49D0-BE9E-2B2459A670F2}}" Code="902" Name="Себестоимость реализованных товаров" PlanID="70" SaldoType="0" Tag="SYS402" Type="1" Memo=""/>
			</account>
			<account ID="338" GUID="{guid {9A36ECFE-2EBF-4F6C-A72B-9FF3D8E0CD78}}" Code="71" Name="Другой операционный доход" PlanID="70" SaldoType="0" Tag="SYS338" Type="1" Memo="">
				<account ID="340" GUID="{guid {1AED0F61-E203-4DCE-BAE7-DD2FA05300F6}}" Code="712" Name="Доход от реализации других оборотных активов" PlanID="70" SaldoType="0" Tag="SYS340" Type="1" Memo=""/>
				<account ID="347" GUID="{guid {4C5C7A3F-3A7A-4595-B643-771C847F6172}}" Code="719" Name="Другие доходы от операционной деятельности" PlanID="70" SaldoType="0" Tag="SYS347" Type="1" Memo=""/>
			</account>
			<account ID="167" GUID="{guid {2D3B1D29-D5E4-4ED3-9689-AAEF9EF0607E}}" Code="20" Name="Производственные запасы" PlanID="70" SaldoType="0" Tag="SYS167" Type="0" Memo="">
				<account ID="168" GUID="{guid {4D330E66-9F63-48D3-9557-5F1353A1287A}}" Code="201" Name="Сырье и материалы" PlanID="70" SaldoType="0" Tag="SYS168" Type="0" Memo=""/>
				<account ID="176" GUID="{guid {4FDB4ACE-9573-4D40-830C-8A57EEF113D6}}" Code="209" Name="Другие материалы" PlanID="70" SaldoType="0" Tag="SYS176" Type="0" Memo=""/>
			</account>
			<account ID="200" GUID="{guid {1F72141A-35A6-4109-A5C6-9D1F97649964}}" Code="30" Name="Наличность" PlanID="70" SaldoType="0" Tag="SYS200" Type="0" Memo="">
				<account ID="201" GUID="{guid {CCEBE0A5-5FD6-4E6B-82EC-D3BA9E55E2D9}}" Code="301" Name="Касса в национальной валюте" PlanID="70" SaldoType="0" Tag="SYS201" Type="0" Memo=""/>
			</account>
			<account ID="367" GUID="{guid {FB97F106-65B3-4213-A412-397828764683}}" Code="79" Name="Финансовые результаты" PlanID="70" SaldoType="0" Tag="SYS367" Type="2" Memo="">
				<account ID="368" GUID="{guid {41258AFE-1943-4498-A5EA-7FDA78E35836}}" Code="791" Name="Результат операционной деятельности" PlanID="70" SaldoType="0" Tag="SYS368" Type="0" Memo=""/>
			</account>
			<account ID="356" GUID="{guid {4DFF0AEE-62F5-493F-8F44-2A44A0812D66}}" Code="74" Name="Другие доходы" PlanID="70" SaldoType="0" Tag="SYS356" Type="1" Memo="">
				<account ID="361" GUID="{guid {758E9105-7344-43D3-B72C-8182F2C3B5EA}}" Code="745" Name="Доход от безвозмездно полученных активов" PlanID="70" SaldoType="0" Tag="SYS361" Type="1" Memo=""/>
			</account>
			<account ID="69" GUID="{guid {D7ACAED9-296D-11D3-A02D-0080480180F7}}" Code="00" Name="&lt;&lt;Вступительный баланс&gt;&gt;" PlanID="70" SaldoType="0" Tag="SYS69" Type="-2" Memo=""/>
			<account ID="298" GUID="{guid {63451D75-B109-46E6-BF95-16E0C984C96B}}" Code="63" Name="Расчеты с поставщиками и подрядчиками" PlanID="70" SaldoType="1" Tag="SYS298" Type="2" Memo="">
				<account ID="299" GUID="{guid {28810B79-220B-4ADA-99AD-E459956EF7C2}}" Code="631" Name="Расчеты с отечественными поставщиками" PlanID="70" SaldoType="0" Tag="SYS299" Type="2" Memo=""/>
			</account>
			<account ID="154" GUID="{guid {5440CD06-2D22-473D-AB18-3A13628B992E}}" Code="15" Name="Капитальные инвестиции" PlanID="70" SaldoType="0" Tag="SYS154" Type="0" Memo="">
				<account ID="156" GUID="{guid {41210D19-B78D-4587-93A0-3EF107E7BB1C}}" Code="152" Name="Приобретение (изготовление) основных средств" PlanID="70" SaldoType="0" Tag="SYS156" Type="0" Memo=""/>
			</account>
			<account ID="140" GUID="{guid {C13EB2D8-2AAD-4691-BE58-61D64A4682F8}}" Code="13" Name="Износ (амортизация) необоротных активов" PlanID="70" SaldoType="0" Tag="SYS140" Type="1" Memo="">
				<account ID="141" GUID="{guid {7D1FE7F5-1BD4-4DA1-9704-20BB4EA89370}}" Code="131" Name="Износ основных средств" PlanID="70" SaldoType="0" Tag="SYS141" Type="1" Memo="">
					<account ID="142" GUID="{guid {D9D0C650-AD87-470C-A4CE-B412C10D7634}}" Code="1313" Name="Износ ОС по счету 103" PlanID="70" SaldoType="0" Tag="SYS142" Type="1" Memo=""/>
					<account ID="143" GUID="{guid {FE68D619-5A98-4DCA-90AA-D1F7A50A3AF5}}" Code="1314" Name="Износ по счету 104" PlanID="70" SaldoType="0" Tag="SYS143" Type="1" Memo=""/>
					<account ID="144" GUID="{guid {68984B66-DF8B-4291-B387-F63AB6EB1BBE}}" Code="1315" Name="Износ ОС по счету 105" PlanID="70" SaldoType="0" Tag="SYS144" Type="1" Memo=""/>
					<account ID="145" GUID="{guid {1EB518B1-D07B-40BF-A8AA-96D7BFC7CC76}}" Code="1316" Name="Износ  ОС по счету 106" PlanID="70" SaldoType="0" Tag="SYS145" Type="1" Memo=""/>
					<account ID="146" GUID="{guid {8CDF7BA0-54EB-464A-83A5-09DC7E5D6A99}}" Code="1317" Name="Износ прочих НА" PlanID="70" SaldoType="0" Tag="SYS146" Type="1" Memo=""/>
					<account ID="147" GUID="{guid {15E31CBA-6ECE-48CC-B3BB-64997C430D91}}" Code="1319" Name="Износ ОС по счету 109" PlanID="70" SaldoType="0" Tag="SYS147" Type="1" Memo=""/>
				</account>
			</account>
		</account>
	</AccentAccounts>
	<AccentUnits>
		<unit ID="1" GUID="{guid {11844C8B-7339-11D4-A311-E209799B0A26}}" Name="Штуки" ShortName="шт" Memo="" Tag="2009" TypeName="Unit"/>
	</AccentUnits>
	<AccentCurs/>
	<AccentForms>
		<form ANID="98" FileName="HL74_AssetsRun.afm" ID="930" Name="ОС. Акт ввода в эксплуатацию основного средства" ShortName="ОАВ" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {6D749521-8402-46A4-9493-707D7B7EE392}}"/>
		<form ANID="97" FileName="HL74_AssetsCalc.afm" ID="932" Name="ОС. Ведомость расчета амортизации" ShortName="ОВА" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {74C7BCED-4986-4BE3-A859-AF58F5A4B504}}"/>
		<form ANID="96" FileName="HL74_AssetsInternalMoving.afm" ID="929" Name="ОС. Акт приема передачи основных средств" ShortName="ОАП" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {98D0CD2E-DA6C-4FB2-AE37-8735B521D904}}"/>
		<form ANID="95" FileName="HL74_AssetsArrival.afm" ID="931" Name="ОС. Накладная на поступление основных средств" ShortName="ОПН" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {792D7059-B0E1-445B-AF82-52245FF29393}}"/>
		<form ANID="78" FileName="HL74_InventoryList.afm" ID="691" Name="Товары. Инвентаризационная опись" ShortName="ТИО" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {97E2CEB9-8A05-4812-852A-292730DBBE2A}}"/>
		<form ANID="68" FileName="HL74_ArrivalOrder (WT).afm" ID="319" Name="Товары. Приходная накладная" ShortName="ТПН" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {87905062-D1EE-11D5-8141-0002440B6A16}}"/>
		<form ANID="69" FileName="HL74_SellingOrder (WT).afm" ID="320" Name="Товары. Расходная накладная" ShortName="ТРН" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {87905063-D1EE-11D5-8141-0002440B6A16}}"/>
		<form ANID="89" FileName="HL74_BuyerReturn (RT).afm" ID="810" Name="Магазин. Возврат товара от покупателя" ShortName="МВК" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {188DD830-0746-49FB-8109-B87A5757AFAC}}"/>
		<form ANID="90" FileName="HL74_SupplierReturn (RT).afm" ID="811" Name="Магазин. Возврат товара поставщику" ShortName="МВС" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {BC642D70-9FE5-42BF-9B05-4C0ABEBD4620}}"/>
		<form ANID="84" FileName="HL74_ArrivalOrder (RT).afm" ID="808" Name="Магазин. Приходная накладная" ShortName="МПН" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {C1F79DC1-DA3F-4CC2-B16A-36C9B8B7702D}}"/>
		<form ANID="85" FileName="HL74_SellingOrder (RT).afm" ID="815" Name="Магазин. Реализация товара" ShortName="МРТ" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {7094D5C1-1AB2-48E5-8D34-C4CDEFF85B1D}}"/>
		<form ANID="49" FileName="HL74_StuffsArrival.afm" ID="705" Name="Материалы. Поступление" ShortName="МПН" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {3FC0F86E-9FF9-4C9C-A94F-8B5D8C42740C}}"/>
		<form ANID="69" FileName="HL74_StuffsDiscarding.afm" ID="361" Name="Материалы. Расходная накладная." ShortName="МРС" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {30888950-1A18-11D6-8142-0002440B6A16}}"/>
		<form ANID="63" FileName="HL74_BuyerReturn (WT).afm" ID="322" Name="Товары. Накладная на возврат от покупателя" ShortName="ТВК" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {879051B0-D1EE-11D5-8141-0002440B6A16}}"/>
		<form ANID="63" FileName="HL74_SupplierReturn (WT).afm" ID="321" Name="Товары. Накладная на возврат поставщику" ShortName="ТВП" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {879051AF-D1EE-11D5-8141-0002440B6A16}}"/>
		<form ANID="79" FileName="HL74_TTN_2014.afm" ID="775" Name="Товары. Товаро транспортная накладная" ShortName="ТТН" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {B9964DBF-B3A8-4150-B8C8-ED651A823F3E}}"/>
		<form ANID="94" FileName="HL74_TTN_Hole.afm" ID="907" Name="Товары. Товаро-транспортная накладная (ГТД)" ShortName="ГТД" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {D144A241-1ADE-4461-A952-914F0BBEA9A6}}"/>
		<form ANID="52" FileName="HL74_ActExecutedActivities.afm" ID="308" Name="Услуги. Акт выполненных работ без НДС (оказанные)" ShortName="АВР" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {5217F1AF-D1D0-11D5-8141-0002440B6A16}}"/>
		<form ANID="0" FileName="HL74_ActExecutedActivities.afm" ID="704" Name="Услуги. Акт выполненных работ без НДС (полученные)" ShortName="" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {89183A36-C534-4F92-9454-5343D14FDDC2}}"/>
		<form ANID="91" FileName="HL74_PriceChanging (RT).afm" ID="809" Name="Магазин. Акт переоценки товара" ShortName="МАП" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {73A81AC5-A51D-49FB-AE50-5DF7768051BE}}"/>
		<form ANID="86" FileName="HL74_MoveWT2RT.afm" ID="812" Name="Магазин. Пемещение товара . Опт-&gt;Розница" ShortName="МПР" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {E27BF6A8-4664-41CB-97B8-C79F7C15B05A}}"/>
		<form ANID="87" FileName="HL74_RemoveToWT.afm" ID="813" Name="Магазин. Перемещение товара. Розница -&gt; Опт" ShortName="МПО" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {1D6EACDB-62BD-4429-80E0-1B1085D97FB7}}"/>
		<form ANID="88" FileName="HL74_InternalMoving (RT).afm" ID="814" Name="Магазин. Внутреннее перемещение" ShortName="МПТ" Tag="" Type="0" TypeName="ProjectItem" GUID="{guid {C0763A14-1EB5-4E62-9B11-E7E738B6CB97}}"/>
	</AccentForms>
	<AccentAutoNum>
		<AutoNum ID="49" PR="" SF="" NAME="Материалы. Приходная накладная"/>
		<AutoNum ID="52" PR="" SF="" NAME="Услуги оказанные. Акт выполненных работ"/>
		<AutoNum ID="63" PR="" SF="" NAME="Товары. Накладная на возврат поставщику"/>
		<AutoNum ID="68" PR="" SF="" NAME="Товары. Приходная накладная"/>
		<AutoNum ID="69" PR="" SF="" NAME="Товары. Расходная накладная"/>
		<AutoNum ID="78" PR="" SF="" NAME="Товары. Инвентаризционная опись"/>
		<AutoNum ID="79" PR="" SF="" NAME="Товары. Товаро-транспортная накладная"/>
		<AutoNum ID="84" PR="" SF="" NAME="Магазин. Приходная накладная"/>
		<AutoNum ID="85" PR="" SF="" NAME="Магазин. Реализация товара"/>
		<AutoNum ID="86" PR="" SF="" NAME="Магазин. Перемещение (опт.-&gt;розн.)"/>
		<AutoNum ID="87" PR="" SF="" NAME="Магазин. Перемещение (розн.-&gt;опт.)"/>
		<AutoNum ID="88" PR="" SF="" NAME="Магазин. Перемещение (розн.-&gt;розн.)"/>
		<AutoNum ID="89" PR="" SF="" NAME="Магазин. Возврат от покупателя"/>
		<AutoNum ID="90" PR="" SF="" NAME="Магазин. Возврат поставщику"/>
		<AutoNum ID="91" PR="" SF="" NAME="Магазин. Акт переоценки товара"/>
		<AutoNum ID="94" PR="" SF="" NAME="Товары. (ГТД) Товаро-транспортная накладная"/>
		<AutoNum ID="95" PR="" SF="" NAME="ОС. Приходная накладная"/>
		<AutoNum ID="96" PR="" SF="" NAME="ОС. Акт приема-передачи"/>
		<AutoNum ID="97" PR="" SF="" NAME="ОС. Ведомость расчета амортизации"/>
		<AutoNum ID="98" PR="" SF="" NAME="ОС. Акт ввода в эксплуатацию"/>
	</AccentAutoNum>
	<AccentEnums>
		<enum Name="Виды деятельности" ID="13" Tag="">
			<enum Name="Компьютерное программирование" ID="98" Tag="62.01"/>
			<enum Name="Оптовая торговля компьютерами,переферийным оборудо" ID="97" Tag="46.51"/>
		</enum>
		<enum Name="Методы расчета износа" ID="12" Tag ="">
			<enum Name="Прямолинейный" ID="96" Tag=""/>
		</enum>
	</AccentEnums>
	
	<AccentTaxReps>
		<taxrep Name="Декларация. Упрощенный налог. Приложение А" FileName="Декларация_Упрощенный налог_Приложение А.ash" ID="1" Tag="ДПУ-А"/>
		<taxrep Name="Декларация. Упрощенный налог. Приложение Б" FileName="Декларация_Упрощенный налог_Приложение Б.ash" ID="2" Tag="ДПУ-Б"/>
		<taxrep Name="Декларация о прибыли " FileName="Декларация_Упрощенный налог.ash" ID="3" Tag="ДПУ"/>
	</AccentTaxReps>
	
	<AccentWorkarea ident="guid">
		<scripts>
			<query type="OLEDB" name="HL74_AssetAccAgEntSum" cmd="add" lastmodifieddate="7/3/2016 11:36:54 AM">procedure HL74_AssetAccAgEntSum
		@AccID int, 
		@AgID int, 
		@EntID int, 
		@onDate DateTime, 
		@DocID int, 
		@MC int

		as 

		set nocount on ;

		SELECT Sum(j_sum*
					case 
						when acc_db=@AccID And j_ag1=@AgID then 1 else 0
					end 
					- case
						when acc_cr=@AccID And j_ag2=@AgID then 1 else 0
					end) as AssetSum
		FROM JOURNAL
		WHERE JOURNAL.J_DONE=2 
				AND JOURNAL.J_DATE&lt;=@OnDate 
				and JOURNAL.j_ent=@EntID
				and JOURNAL.DOC_ID&lt;&gt;@DocID
				and JOURNAL.MC_ID=@MC
				AND ((acc_db=@AccID And j_ag1=@AgID) Or (acc_cr=@AccID And j_ag2=@AgID))
			</query>
			<query type="OLEDB" name="HL74_Report_Profit" cmd="add" lastmodifieddate="7/3/2016 12:22:29 PM">procedure HL74_Report_Profit

		@Acc361ID int, 
		@Acc702ID int, 
		@Acc902ID int, @Acc281ID int,
		@dStart DateTime, 
		@dEnd DateTime, 
		@MCID int

		as 

		set nocount on ;

		create table #tmp (AgID int, EntID int, SaleSum Money, SaleQty Money, CostSum Money, CostQty Money)

		insert into #tmp (AgID, EntID, SaleSum, SaleQty, CostSum, CostQty )
		SELECT J.J_AG1 as AgID, J.J_ENT as EntID, sum(J.J_SUM) as SaleSum, sum(J.J_QTY) as SaleQty, 0 as CostSum, 0 as CostQty
		FROM JOURNAL AS J
		WHERE J.J_DONE= 2 
		AND J.J_DATE&gt;=@dStart 
		And J.J_DATE&lt;@dEnd
		AND J.MC_ID=@MCID 
		AND J.ACC_DB in (select id from acc_tree where p0=@Acc361ID or p1=@Acc361ID or p2=@Acc361ID or p3=@Acc361ID or p4=@Acc361ID or p5=@Acc361ID or p6=@Acc361ID or p7=@Acc361ID or id=@Acc361ID)
		AND j.ACC_CR in (select id from acc_tree where p0=@Acc702ID or p1=@Acc702ID or p2=@Acc702ID or p3=@Acc702ID or p4=@Acc702ID or p5=@Acc702ID or p6=@Acc702ID or p7=@Acc702ID or id=@Acc702ID)

		group by J.J_AG1, J.J_ENT

		UNION ALL SELECT J.J_AG1 as AgID, J.J_ENT as EntID, 0 as SaleSum, 0 as SaleQty, sum(J.J_SUM) as CostSum, sum(J.J_QTY) as CostQty
		FROM JOURNAL AS J
		WHERE J.J_DONE=2 
		AND J.J_DATE&gt;= @dStart
		And J.J_DATE&lt; @dEnd
		AND J.MC_ID= @MCID

		AND J.ACC_CR in (select id from acc_tree where p0=@Acc281ID or p1=@Acc281ID or p2=@Acc281ID or p3=@Acc281ID or p4=@Acc281ID or p5=@Acc281ID or p6=@Acc281ID or p7=@Acc281ID or id=@Acc281ID)
		AND j.ACC_DB in (select id from acc_tree where p0=@Acc902ID or p1=@Acc902ID or p2=@Acc902ID or p3=@Acc902ID or p4=@Acc902ID or p5=@Acc902ID or p6=@Acc902ID or p7=@Acc902ID or id=@Acc902ID)

		group by J.J_AG1, J.J_ENT


		SELECT	AGENTS.AG_ID, 
				AGENTS.AG_NAME, 
				ENTITIES.ENT_ID, 
				ENTITIES.ENT_NAME, 
				Sum(#tmp.CostSum) AS TotalCostSum, 
				Sum(#tmp.CostQty) AS TotalCostQty, 
				Sum(#tmp.SaleSum) AS TotalSaleSum, 
				Sum(#tmp.SaleQty) AS TotalSaleQty
		FROM (#tmp LEFT JOIN AGENTS ON #tmp.AgID = AGENTS.AG_ID) 
				LEFT JOIN ENTITIES ON #tmp.EntID = ENTITIES.ENT_ID

		GROUP BY AGENTS.AG_ID, AGENTS.AG_NAME, ENTITIES.ENT_ID, ENTITIES.ENT_NAME
		ORDER BY AGENTS.AG_NAME, AGENTS.AG_ID, ENTITIES.ENT_NAME, ENTITIES.ENT_ID

			</query>
			<query type="OLEDB" name="ST7_GetMidEntPrice" cmd="add" lastmodifieddate="7/3/2016 11:19:26 AM">
		PROCEDURE [dbo].[ST7_GetMidEntPrice]
			  @AgID Int, @AccID Int, @EntID Int, @DocID Int, @OnDate DateTime, @MC int

		AS
		SET NOCOUNT ON

		Select	Sum(Case 
						When ACC_DB = @AccID And J_AG1 = @AgID Then J_QTY 
						Else 0 
					End - 
					case 
						when ACC_CR = @AccID and J_AG2 = @AgID and j_DATE &lt; @OnDate then J_QTY
						else 0
					end),
				Sum(Case 
						When ACC_DB = @AccID And J_AG1 = @AgID Then J_SUM 
						Else 0 
					End - 
					case
						when ACC_CR = @AccID and J_AG2 = @AgID and j_DATE &lt; @OnDate then J_SUM
						else 0
					end),
				Sum(Case 
						When ACC_DB = @AccID And J_AG1 = @AgID Then J_QTY
						Else 0 
					End - 
					case
						when ACC_CR = @AccID and J_AG2 = @AgID then J_QTY
						else 0
					end),
				Sum(Case 
						When ACC_DB = @AccID And J_AG1 = @AgID Then J_SUM 
						Else 0 
					End - 
					case
						when ACC_CR = @AccID and J_AG2 = @AgID then J_SUM
						else 0
					end)


		FROM JOURNAL
		Where (ACC_DB = @AccID And J_AG1 = @AgID Or ACC_CR = @AccID And J_AG2 = @AgID) And 
		J_DONE = 2 And J_DATE &lt;= @OnDate And J_ENT = @EntID And DOC_ID &lt;&gt; @DocID And MC_ID = @MC;





			</query>
			<query type="OLEDB" name="ST7_TaxInDocs" cmd="add" lastmodifieddate="7/3/2016 11:24:41 AM">procedure ST7_TaxInDocs
		@Acc631ID int, 
		@StartDate DateTime, 
		@EndDate DateTime, 
		@MCID int, 
		@TaxRepID int

		as

		set nocount on ;

		SELECT AG_REGNO, AG_NAME, J_DATE, DOC_NO, SUM(J_SUM)
		FROM ((JRN_TAX AS JT INNER JOIN JOURNAL AS J ON J.J_ID = JT.J_ID) INNER JOIN DOCUMENTS AS D ON D.DOC_ID = J.DOC_ID) INNER JOIN AGENTS AS A ON A.AG_ID = J.J_AG2
		WHERE JT.TX_ID = @TaxRepID And JT_ADDR1 = 'Д.А.' And J.MC_ID = @MCID And ACC_CR = @Acc631ID And J_DATE &gt;= @StartDate And J_DATE &lt; @EndDate And  J_DONE = 2
		GROUP BY AG_REGNO, AG_NAME, J_DATE, DOC_NO;
			</query>
			<query type="OLEDB" name="ST7_TaxInDocsB" cmd="add" lastmodifieddate="7/3/2016 11:26:04 AM">procedure ST7_TaxInDocsB
		@Acc631ID int, 
		@StartDate DateTime, 
		@EndDate DateTime, 
		@MCID int, 
		@TaxRepID int

		as

		set nocount on ;

		SELECT AG_REGNO, AG_NAME, SUM(J_SUM)
		FROM (JRN_TAX AS JT INNER JOIN JOURNAL AS J ON J.J_ID = JT.J_ID) INNER JOIN AGENTS AS A ON A.AG_ID = J.J_AG2
		WHERE JT.TX_ID = @TaxRepID And JT_ADDR1 = 'Д.Б.' And J.MC_ID = @MCID And ACC_CR = @Acc631ID And J_DATE &gt;= @StartDate And J_DATE &lt; @EndDate And  J_DONE = 2
		GROUP BY AG_REGNO, AG_NAME
			</query>
			<query type="OLEDB" name="ST7_TaxOutDocs" cmd="add" lastmodifieddate="7/3/2016 11:27:11 AM">procedure ST7_TaxOutDocs
		@Acc361ID int, 
		@StartDate DateTime, 
		@EndDate DateTime, 
		@MCID int, 
		@TaxRepID int

		as

		set nocount on ;

		SELECT AG_REGNO, AG_NAME, J_DATE, DOC_NO, SUM(J_SUM)
		FROM ((JRN_TAX AS JT INNER JOIN JOURNAL AS J ON J.J_ID = JT.J_ID) INNER JOIN DOCUMENTS AS D ON D.DOC_ID = J.DOC_ID) INNER JOIN AGENTS AS A ON A.AG_ID = J.J_AG1
		WHERE JT.TX_ID = @TaxRepID And JT_ADDR1 = 'Д.А.' And J.MC_ID = @MCID And ACC_DB = @Acc361ID And J_DATE &gt;= @StartDate And J_DATE &lt; @EndDate And  J_DONE = 2
		GROUP BY AG_REGNO, AG_NAME, J_DATE, DOC_NO;
			</query>
			<query type="OLEDB" name="ST74_AssetsGetRest" cmd="add" lastmodifieddate="7/3/2016 11:58:03 AM">procedure ST74_AssetsGetRest
		@AccID10 int, 
		@AccID13 int, 
		@OnDate DateTime, 
		@DocID int, 
		@MCID int

		as

		set nocount on ;

		select	JOURNAL.J_ENT, 
				JOURNAL.J_AG1 as AgID, 
				sum(JOURNAL.J_SUM), 
				sum(JOURNAL.J_SUM *
					case 
						when JOURNAL.ACC_DB = @AccID13 then -1 else 0 
					end), 
				ENTITIES.ENT_NAME 
		from journal left join ENTITIES on ENTITIES.ENT_ID = JOURNAL.J_ENT

		where JOURNAL.DOC_ID &lt;&gt; @DocID 
			and JOURNAL.MC_ID = @MCID 
			and JOURNAL.J_DONE = 2 
			and JOURNAL.J_DATE &lt; @OnDate 
			and (JOURNAL.ACC_DB = @AccID13 or 
				JOURNAL.ACC_DB in (
					select id 
						from acc_tree 
						where p0 = @AccID10 
							or p1 = @AccID10 
							or p2 = @AccID10 
							or p3 = @AccID10 
							or p4 = @AccID10 
							or p5 = @AccID10 
							or p6 = @AccID10 
							or p7 = @AccID10 
							or id = @AccID10))
		group by JOURNAL.J_ENT, JOURNAL.J_AG1, ENTITIES.ENT_NAME 

		UNION ALL 

		select JOURNAL.J_ENT, 
				JOURNAL.J_AG2 AS AgID, 
				-sum(JOURNAL.J_SUM), 
				-sum(JOURNAL.J_SUM * 
					case 
						when JOURNAL.ACC_CR = @AccID13 then -1 else 0
					end), 
				ENTITIES.ENT_NAME 

		from ENTITIES 
			inner join JOURNAL on ENTITIES.ENT_ID = JOURNAL.J_ENT 

		where	JOURNAL.DOC_ID &lt;&gt; @DocID 
				and JOURNAL.MC_ID = @MCID 
				and JOURNAL.J_DONE = 2 
				and JOURNAL.J_DATE &lt; @OnDate 
				and (JOURNAL.ACC_CR = @AccID13 or 
					JOURNAL.ACC_CR in (
							select id 
							from acc_tree 
							where p0 = @AccID10 
									or p1 = @AccID10 
									or p2 = @AccID10 
									or p3 = @AccID10 
									or p4 = @AccID10 
									or p5 = @AccID10 
									or p6 = @AccID10 
									or p7 = @AccID10 
									or id = @AccID10)) 

		group by JOURNAL.J_ENT, JOURNAL.J_AG2, ENTITIES.ENT_NAME
		ORDER BY ENT_NAME, J_ENT, AgID
			</query>
			<query type="OLEDB" name="ST74_AssetsGetRestEnt" cmd="add" lastmodifieddate="7/3/2016 11:59:39 AM">procedure ST74_AssetsGetRestEnt
		@EntID int, 
		@AccID10 int, 
		@AccID13 int, 
		@OnDate DateTime, 
		@DocID int, 
		@MCID int

		as

		set nocount on ;

		select	JOURNAL.J_ENT, 
				JOURNAL.J_AG1 as AgID, 
				sum(JOURNAL.J_SUM), 
				sum(JOURNAL.J_SUM *
					case 
						when JOURNAL.ACC_DB = @AccID13 then -1 else 0 
					end), 
				ENTITIES.ENT_NAME 
		from journal left join ENTITIES on ENTITIES.ENT_ID = JOURNAL.J_ENT

		where JOURNAL.DOC_ID &lt;&gt; @DocID 
			and JOURNAL.J_ENT = @EntID 
			and JOURNAL.MC_ID = @MCID 
			and JOURNAL.J_DONE = 2 
			and JOURNAL.J_DATE &lt; @OnDate 
			and (JOURNAL.ACC_DB = @AccID13 or 
				JOURNAL.ACC_DB in (
					select id 
						from acc_tree 
						where p0 = @AccID10 
							or p1 = @AccID10 
							or p2 = @AccID10 
							or p3 = @AccID10 
							or p4 = @AccID10 
							or p5 = @AccID10 
							or p6 = @AccID10 
							or p7 = @AccID10 
							or id = @AccID10))
		group by JOURNAL.J_ENT, JOURNAL.J_AG1, ENTITIES.ENT_NAME 

		UNION ALL 

		select JOURNAL.J_ENT, 
				JOURNAL.J_AG2 AS AgID, 
				-sum(JOURNAL.J_SUM), 
				-sum(JOURNAL.J_SUM * 
					case 
						when JOURNAL.ACC_CR = @AccID13 then -1 else 0
					end), 
				ENTITIES.ENT_NAME 

		from ENTITIES 
			inner join JOURNAL on ENTITIES.ENT_ID = JOURNAL.J_ENT 

		where	JOURNAL.DOC_ID &lt;&gt; @DocID 
				and JOURNAL.J_ENT = @EntID 
				and JOURNAL.MC_ID = @MCID 
				and JOURNAL.J_DONE = 2 
				and JOURNAL.J_DATE &lt; @OnDate 
				and (JOURNAL.ACC_CR = @AccID13 or 
					JOURNAL.ACC_CR in (
							select id 
							from acc_tree 
							where p0 = @AccID10 
									or p1 = @AccID10 
									or p2 = @AccID10 
									or p3 = @AccID10 
									or p4 = @AccID10 
									or p5 = @AccID10 
									or p6 = @AccID10 
									or p7 = @AccID10 
									or id = @AccID10)) 

		group by JOURNAL.J_ENT, JOURNAL.J_AG2, ENTITIES.ENT_NAME
		ORDER BY ENT_NAME, J_ENT, AgID
			</query>
			<query type="OLEDB" name="ST74_CalcEntRest" cmd="add" lastmodifieddate="7/3/2016 11:20:34 AM">
		PROCEDURE [dbo].[ST74_CalcEntRest]
		   @AgID Int, 
		   @AccID Int, 
		   @DocID Int, 
		   @OnDate DateTime, 
		   @MC int

		AS
		SET NOCOUNT ON

		---
		--- Создаем временную таблицу для выборки объектов в разрезе серий
		---
		CREATE TABLE #Ent(SerID int, EntID int, RestQty Money, RestSum Money)

		--вставляем дебет (с плюсами)
		INSERT INTO #Ent (SerID, EntID, RestQty, RestSum)

		SELECT SER_ID, J_ent, 
			sum(CASE 
				WHEN (ACC_DB=@AccID And J_AG1=@AgID ) THEN IsNull(J_QTY, 0)
			ELSE 0
			END),

			sum(CASE 
				WHEN (ACC_DB=@AccID And J_AG1=@AgID) THEN J_SUM
			ELSE 0
			END)

		FROM JOURNAL
		WHERE JOURNAL.ACC_DB=@AccID AND JOURNAL.J_AG1=@AgID
				and JOURNAL.J_DONE=2
				AND (doc_id&lt;&gt;@DocID) 
				AND (JOURNAL.J_DATE&lt;=@OnDate) 
				and JOURNAL.MC_ID = @MC
		group by SER_ID, J_ent
		--вставляем кредит (с минусами)
		INSERT INTO #Ent (SerID, EntID, RestQty, RestSum)

		SELECT SER_ID, J_ent, 
			sum(CASE 
				WHEN (ACC_CR=@AccID And J_AG2=@AgID ) THEN IsNull(-J_QTY, 0)
			ELSE 0
			END),

			sum(CASE 
				WHEN (ACC_CR=@AccID And J_AG2=@AgID) THEN -J_SUM
			ELSE 0
			END)

		FROM JOURNAL
		WHERE	JOURNAL.ACC_CR=@AccID AND JOURNAL.J_AG2=@AgID
				and JOURNAL.J_DONE=2
				AND (doc_id&lt;&gt;@DocID) 
				AND (JOURNAL.J_DATE&lt;=@OnDate) 
				and JOURNAL.MC_ID = @MC
		group by SER_ID, J_ent
		--Окончательная выборка
		SELECT	0, 
				EntID, 
				Sum(RestQty) AS RestQty, 
				Sum (RestSum) AS RestSum
		FROM #Ent 
		group by EntID
		HAVING Sum(RestQty)&lt;&gt;0 or Sum(RestSum)&lt;&gt;0 

		drop table #Ent




			</query>
			<query type="OLEDB" name="ST74_Child_doc_list" cmd="add" lastmodifieddate="7/3/2016 12:40:15 PM">procedure ST74_Child_doc_list
		@AccPayID int, 
		@dStart DateTime, 
		@dEnd DateTime, 
		@mc int

		as 

		set nocount on ;

		SELECT	DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO, 
				JOURNAL.J_AG2, 
				JOURNAL.DOC_ID, 
				Sum(JOURNAL.J_SUM), 
				JOURNAL.PDOC_ID

		FROM (ACC_TREE LEFT JOIN JOURNAL ON ACC_TREE.ID = JOURNAL.ACC_CR) LEFT JOIN DOCUMENTS ON JOURNAL.DOC_ID = DOCUMENTS.DOC_ID

		WHERE JOURNAL.J_DONE=2 
				AND JOURNAL.MC_ID=@MC
				AND @AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7,ID)

		GROUP BY DOCUMENTS.DOC_DATE, DOCUMENTS.DOC_NO, JOURNAL.J_AG2, JOURNAL.DOC_ID, JOURNAL.PDOC_ID
		HAVING DOCUMENTS.DOC_DATE&gt;=@dStart And DOCUMENTS.DOC_DATE&lt;@dEnd
			</query>
			<query type="OLEDB" name="ST74_Dlg_InvList" cmd="add" lastmodifieddate="7/3/2016 12:53:47 PM">procedure ST74_Dlg_InvList

		@AccInvoiceID int, 
		@AccPayID int, 
		@AgreeMscNo int, 
		@OnDate DateTime, 
		@DocID int, 
		@MC int

		as

		set nocount on ;

		create table #tmp1(OpID int, DocDate datetime, DocNo nvarchar(50), DocSum money, DocMemo nvarchar(255), MscID int)

		insert into #tmp1(OpID, DocDate, DocNo, DocSum, DocMemo, MscID)
		SELECT JOURNAL.DOC_ID AS OpID, 
				JOURNAL.J_DATE AS DocDate, 
				DOCUMENTS.DOC_NO AS DocNo, 
				Sum(JOURNAL.j_sum) AS DocSum, 
				DOCUMENTS.DOC_MEMO AS DocMemo, 
				JRN_MISC.MSC_ID AS MscID
		FROM (JOURNAL LEFT JOIN DOCUMENTS ON JOURNAL.DOC_ID = DOCUMENTS.DOC_ID) INNER JOIN JRN_MISC ON JOURNAL.J_ID = JRN_MISC.J_ID
		WHERE 
				JOURNAL.J_DONE=2
				AND JOURNAL.J_DATE&lt;= @OnDate
				AND JOURNAL.MC_ID=@MC
				AND JOURNAL.ACC_DB=@AccInvoiceID
				AND ([MSC_NO]=@AgreeMscNo Or IsNull(MSC_NO, 0) = 0)
		GROUP BY 
				JOURNAL.DOC_ID, 
				JOURNAL.J_DATE, 
				DOCUMENTS.DOC_NO, 
				DOCUMENTS.DOC_MEMO, 
				JRN_MISC.MSC_ID

		create table #tmp2(PaidSum money, pdoc_id int)
		insert into #tmp2(PaidSum, pdoc_id)

		SELECT Sum(journal.j_sum) AS PaidSum, journal.pdoc_id as pdoc_id
		FROM ACC_TREE LEFT JOIN journal ON ACC_TREE.ID = journal.ACC_CR
		WHERE 
			journal.j_done=2
			AND journal.doc_id&lt;&gt;@DocID	
			AND (@AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7) Or [ACC_CR]=@AccPayID)
			AND journal.mc_id=@MC
			AND journal.j_date&lt;=@OnDate
			AND isnull(ACC_TREE.SHORTCUT, 0) &lt;&gt; 1

		GROUP BY journal.pdoc_id

		SELECT #tmp1.OpID, 
				#tmp1.DocDate, 
				#tmp1.DocNo, 
				#tmp1.DocSum, 
				#tmp2.PaidSum AS PaidSum, 
				#tmp1.DocMemo, 
				#tmp1.MscID

		FROM #tmp1 LEFT JOIN #tmp2 ON #tmp1.OpID = #tmp2.pdoc_id
			</query>
			<query type="OLEDB" name="ST74_InvoicePaid_report" cmd="add" lastmodifieddate="7/3/2016 1:03:15 PM">procedure ST74_InvoicePaid_report

		@AccInvoiceID int, 
		@AccPayID int, 
		@dStart DateTime, 
		@dEnd DateTime, 
		@AgreeMscNo int, 
		@mc int

		as 

		set nocount on;

		SELECT JOURNAL.DOC_ID, 
				AGENTS.AG_NAME, 
				JOURNAL.J_AG1, 
				MISC.MSC_NAME, 
				JRN_MISC.MSC_ID, 
				DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO, 
				Sum(JOURNAL.J_SUM) AS DocSum, 
				(SELECT Sum(j1.j_sum) AS StartSum
					FROM ACC_TREE LEFT JOIN journal as j1 ON ACC_TREE.ID = j1.ACC_DB
					WHERE	j1.pdoc_id = journal.doc_id 
							and j1.j_done=2
							AND (@AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7) Or [ACC_DB]=@AccPayID) 
							AND j1.mc_id=@MC
							AND j1.j_date&lt;@dStart
							AND isnull(ACC_TREE.SHORTCUT, 0) = 1) AS StartSum,
				(SELECT Sum(j2.j_sum) AS StartSum
					FROM ACC_TREE LEFT JOIN journal as j2 ON ACC_TREE.ID = j2.ACC_DB
					WHERE ( j2.pdoc_id = journal.doc_id 
							and j2.j_done=2
							AND ((@AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7) Or [ACC_DB]=@AccPayID)
							AND j2.mc_id = @MC
							AND j2.j_date&gt;= @dStart
							AND j2.j_date&lt;@dEnd
							AND isnull(ACC_TREE.SHORTCUT, 0) = 1))) AS PaidSum

		FROM (DOCUMENTS INNER JOIN (AGENTS INNER JOIN JOURNAL ON AGENTS.AG_ID = JOURNAL.J_AG1) ON DOCUMENTS.DOC_ID = JOURNAL.DOC_ID) INNER JOIN (JRN_MISC INNER JOIN MISC ON JRN_MISC.MSC_ID = MISC.MSC_ID) ON JOURNAL.J_ID = JRN_MISC.J_ID
		WHERE 
				JOURNAL.J_DONE=2
				AND JOURNAL.J_DATE&lt; @dEnd
				AND JOURNAL.ACC_DB=@AccInvoiceID
				AND JOURNAL.MC_ID=@MC
				AND JRN_MISC.MSC_NO=@AgreeMscNo

		GROUP BY 
				JOURNAL.DOC_ID, 
				AGENTS.AG_NAME, 
				JOURNAL.J_AG1, 
				MISC.MSC_NAME, 
				JRN_MISC.MSC_ID, 
				DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO

		ORDER BY 
				AGENTS.AG_NAME, 
				JOURNAL.J_AG1, 
				MISC.MSC_NAME, 
				JRN_MISC.MSC_ID, 
				DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO
			</query>
			<query type="OLEDB" name="ST74_InvoicePaid_report2" cmd="add" lastmodifieddate="7/3/2016 1:07:10 PM">procedure ST74_InvoicePaid_report2

		@AccInvoiceID int, 
		@AccPayID int, 
		@dStart DateTime, 
		@dEnd DateTime, 
		@AgreeMscNo int, 
		@mc int

		as 

		set nocount on;

		SELECT JOURNAL.DOC_ID, 
				AGENTS.AG_NAME, 
				JOURNAL.J_AG1, 
				MISC.MSC_NAME, 
				JRN_MISC.MSC_ID, 
				DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO, 
				Sum(JOURNAL.J_SUM) AS DocSum, 
				(SELECT Sum(j1.j_sum) AS StartSum
					FROM ACC_TREE LEFT JOIN journal as j1 ON ACC_TREE.ID = j1.ACC_CR
					WHERE	j1.pdoc_id = journal.doc_id 
							and j1.j_done=2
							AND (@AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7) Or [ACC_CR]=@AccPayID) 
							AND j1.mc_id=@MC
							AND j1.j_date&lt;@dStart
							AND isnull(ACC_TREE.SHORTCUT, 0) = 1) AS StartSum,
				(SELECT Sum(j2.j_sum) AS StartSum
					FROM ACC_TREE LEFT JOIN journal as j2 ON ACC_TREE.ID = j2.ACC_CR
					WHERE ( j2.pdoc_id = journal.doc_id 
							and j2.j_done=2
							AND ((@AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7) Or [ACC_CR]=@AccPayID)
							AND j2.mc_id = @MC
							AND j2.j_date&gt;= @dStart
							AND j2.j_date&lt;@dEnd
							AND isnull(ACC_TREE.SHORTCUT, 0) = 1))) AS PaidSum

		FROM (DOCUMENTS INNER JOIN (AGENTS INNER JOIN JOURNAL ON AGENTS.AG_ID = JOURNAL.J_AG1) ON DOCUMENTS.DOC_ID = JOURNAL.DOC_ID) INNER JOIN (JRN_MISC INNER JOIN MISC ON JRN_MISC.MSC_ID = MISC.MSC_ID) ON JOURNAL.J_ID = JRN_MISC.J_ID
		WHERE 
				JOURNAL.J_DONE=2
				AND JOURNAL.J_DATE&lt; @dEnd
				AND JOURNAL.ACC_CR=@AccInvoiceID
				AND JOURNAL.MC_ID=@MC
				AND JRN_MISC.MSC_NO=@AgreeMscNo

		GROUP BY 
				JOURNAL.DOC_ID, 
				AGENTS.AG_NAME, 
				JOURNAL.J_AG1, 
				MISC.MSC_NAME, 
				JRN_MISC.MSC_ID, 
				DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO

		ORDER BY 
				AGENTS.AG_NAME, 
				JOURNAL.J_AG1, 
				MISC.MSC_NAME, 
				JRN_MISC.MSC_ID, 
				DOCUMENTS.DOC_DATE, 
				DOCUMENTS.DOC_NO
			</query>
			<query type="OLEDB" name="ST74_PayDcList" cmd="add" lastmodifieddate="7/3/2016 1:12:13 PM">procedure ST74_PayDcList

		@AccPayID int, 
		@pDocID int, 
		@MscID int, 
		@dStart DateTime, 
		@dEnd DateTime, 
		@mc int

		as 

		set nocount on ;

		SELECT	DOCUMENTS.DOC_ID, 
				DOCUMENTS.DOC_NO, 
				DOCUMENTS.DOC_DATE, 
				Sum(j2.j_sum) AS DocSum

		FROM ((ACC_TREE LEFT JOIN journal AS j2 ON ACC_TREE.ID = j2.ACC_CR) LEFT JOIN DOCUMENTS ON j2.DOC_ID = DOCUMENTS.DOC_ID) LEFT JOIN JRN_MISC ON j2.J_ID = JRN_MISC.J_ID

		WHERE j2.j_done=2
				AND (@AccPayID in (p0,p1,p2,p3,p4,p5,p6,p7) Or ACC_CR=@AccPayID)
				AND j2.mc_id=@MC
				AND j2.j_date&gt;=@dStart
				And j2.j_date&lt;@dEnd
				AND isnull(ACC_TREE.SHORTCUT, 0) = 0
				AND j2.pdoc_id=@pDocID
				AND JRN_MISC.MSC_ID=@MscID

		GROUP BY DOCUMENTS.DOC_ID, DOCUMENTS.DOC_NO, DOCUMENTS.DOC_DATE
			</query>
			<query type="DAO" name="HL74_AssetAccAgEntSum" cmd="del"/>
			<query type="DAO" name="HL74_AssetAccAgEntSum" cmd="add" lastmodifieddate="6/25/2016 9:08:57 PM">PARAMETERS AccID Long, AgID Long, EntID Long, onDate DateTime, DocID Long, MC Long;
	SELECT Sum([j_sum]*(IIf([acc_db]=[AccID] And [j_ag1]=[AgID],1,0)-IIf([acc_cr]=[AccID] And [j_ag2]=[AgID],1,0))) AS AssetSum
	FROM JOURNAL
	WHERE (((JOURNAL.J_DONE)=2) AND ((JOURNAL.J_DATE)&lt;=[OnDate]) AND ((([acc_db]=[AccID] And [j_ag1]=[AgID]) Or ([acc_cr]=[AccID] And [j_ag2]=[AgID]))=True) AND ((JOURNAL.MC_ID)=[MC]) AND ((JOURNAL.DOC_ID)&lt;&gt;[DocID]) AND ((JOURNAL.[j_ent])=[EntID ]));
		</query>
		<query type="DAO" name="HL74_Report_Profit" cmd="del"/>
		<query type="DAO" name="HL74_Report_Profit" cmd="add" lastmodifieddate="6/21/2016 11:47:39 AM">SELECT AGENTS.AG_ID, AGENTS.AG_NAME, ENTITIES.ENT_ID, ENTITIES.ENT_NAME, Sum(HL74_Report_Profit_Base.CostSum) AS TotalCostSum, Sum(HL74_Report_Profit_Base.CostQty) AS TotalCostQty, Sum(HL74_Report_Profit_Base.SaleSum) AS TotalSaleSum, Sum(HL74_Report_Profit_Base.SaleQty) AS TotalSaleQty
	FROM (HL74_Report_Profit_Base LEFT JOIN AGENTS ON HL74_Report_Profit_Base.AgID = AGENTS.AG_ID) LEFT JOIN ENTITIES ON HL74_Report_Profit_Base.EntID = ENTITIES.ENT_ID
	GROUP BY AGENTS.AG_ID, AGENTS.AG_NAME, ENTITIES.ENT_ID, ENTITIES.ENT_NAME
	ORDER BY AGENTS.AG_NAME, AGENTS.AG_ID, ENTITIES.ENT_NAME, ENTITIES.ENT_ID;
		</query>
		<query type="DAO" name="HL74_Report_Profit_Base" cmd="del"/>
		<query type="DAO" name="HL74_Report_Profit_Base" cmd="add" lastmodifieddate="6/21/2016 11:47:15 AM">PARAMETERS Acc361ID Long, Acc702ID Long, Acc902ID Long, Acc281ID Long, dStart DateTime, dEnd DateTime, MCID Long;
	SELECT J.J_AG1 as AgID, J.J_ENT as EntID, sum(J.J_SUM) as SaleSum, sum(J.J_QTY) as SaleQty, 0 as CostSum, 0 as CostQty
	FROM JOURNAL AS J
	WHERE J.J_DONE= 2 
	AND J.J_DATE&gt;=[dStart] 
	And J.J_DATE&lt;[dEnd] 
	AND J.MC_ID=[MCID] 
	AND J.ACC_DB in (select id from acc_tree where p0=[Acc361ID] or p1=[Acc361ID] or p2=[Acc361ID] or p3=[Acc361ID] or p4=[Acc361ID] or p5=[Acc361ID] or p6=[Acc361ID] or p7=[Acc361ID] or id=[Acc361ID])
	AND j.ACC_CR in (select id from acc_tree where p0=[Acc702ID] or p1=[Acc702ID] or p2=[Acc702ID] or p3=[Acc702ID] or p4=[Acc702ID] or p5=[Acc702ID] or p6=[Acc702ID] or p7=[Acc702ID] or id=[Acc702ID])

	group by J.J_AG1, J.J_ENT

	UNION ALL SELECT J.J_AG1 as AgID, J.J_ENT as EntID, 0 as SaleSum, 0 as SaleQty, sum(J.J_SUM) as CostSum, sum(J.J_QTY) as CostQty
	FROM JOURNAL AS J
	WHERE J.J_DONE=2 
	AND J.J_DATE&gt;=[dStart] 
	And J.J_DATE&lt;[dEnd] 
	AND J.MC_ID=[MCID] 

	AND J.ACC_CR in (select id from acc_tree where p0=[Acc281ID] or p1=[Acc281ID] or p2=[Acc281ID] or p3=[Acc281ID] or p4=[Acc281ID] or p5=[Acc281ID] or p6=[Acc281ID] or p7=[Acc281ID] or id=[Acc281ID])
	AND j.ACC_DB in (select id from acc_tree where p0=[Acc902ID] or p1=[Acc902ID] or p2=[Acc902ID] or p3=[Acc902ID] or p4=[Acc902ID] or p5=[Acc902ID] or p6=[Acc902ID] or p7=[Acc902ID] or id=[Acc902ID])

	group by J.J_AG1, J.J_ENT;
		</query>
		<query type="DAO" name="HL74_RestByMsc" cmd="del"/>
		<query type="DAO" name="HL74_RestByMsc" cmd="add" lastmodifieddate="6/23/2016 4:40:46 PM">PARAMETERS [AccID] Long, [MscID] Long, OnDate DateTime, DocID Long, MC Long;
	SELECT Sum([j_sum]*(IIf([acc_db]=[AccID],1,0)-IIf([acc_cr]=[AccID],1,0))) AS RestSum, Sum([j_qty]*(IIf([acc_db]=[AccID],1,0)-IIf([acc_cr]=[AccID],1,0))) AS RestQty, Sum([jf_qty]*(IIf([acc_db]=[AccID],1,0)-IIf([acc_cr]=[AccID],1,0))) AS RestFQty
	FROM JOURNAL RIGHT JOIN JRN_MISC ON JOURNAL.J_ID = JRN_MISC.J_ID
	WHERE (((JRN_MISC.MSC_ID)=[MscID]) AND ((JOURNAL.J_DONE)=2) AND ((JOURNAL.J_DATE)&lt;=[OnDate]) AND ((JOURNAL.MC_ID)=[MC]) AND ((([acc_db]=[AccID]) Or ([acc_cr]=[AccID] ))=True)) and doc_id &lt;&gt; [DocID];
		</query>
		<query type="DAO" name="HL74_RestEntAgByMsc" cmd="del"/>
		<query type="DAO" name="HL74_RestEntAgByMsc" cmd="add" lastmodifieddate="6/23/2016 2:38:10 PM">PARAMETERS [EntID] Long, [AccID] Long, [AgID] Long, [MscID] Long, OnDate DateTime, DocID Long, MC Long;
	SELECT Sum([j_sum]*(IIf([acc_db]=[AccID] And [j_ag1]=[AgID],1,0)-IIf([acc_cr]=[AccID] And [j_ag2]=[AgID],1,0))) AS RestSum, Sum([j_qty]*(IIf([acc_db]=[AccID] And [j_ag1]=[AgID],1,0)-IIf([acc_cr]=[AccID] And [j_ag2]=[AgID],1,0))) AS RestQty, Sum([jf_qty]*(IIf([acc_db]=[AccID] And [j_ag1]=[AgID],1,0)-IIf([acc_cr]=[AccID] And [j_ag2]=[AgID],1,0))) AS RestFQty
	FROM JOURNAL RIGHT JOIN JRN_MISC ON JOURNAL.J_ID = JRN_MISC.J_ID
	WHERE (((JRN_MISC.MSC_ID)=[MscID]) AND ((JOURNAL.J_DONE)=2) AND ((JOURNAL.J_DATE)&lt;=[OnDate]) AND ((JOURNAL.MC_ID)=[MC]) AND ((([acc_db]=[AccID] And [j_ag1]=[AgID]) Or ([acc_cr]=[AccID] And [j_ag2]=[AgID]))=True) AND ((JOURNAL.J_ENT)=[EntID])) and doc_id &lt;&gt; [DocID];
		</query>
		<query type="DAO" name="HL74_RestEntByMsc" cmd="del"/>
		<query type="DAO" name="HL74_RestEntByMsc" cmd="add" lastmodifieddate="6/23/2016 3:49:45 PM">PARAMETERS [EntID] Long, [AccID] Long, [MscID] Long, OnDate DateTime, DocID Long, MC Long;
	SELECT Sum([j_sum]*(IIf([acc_db]=[AccID],1,0)-IIf([acc_cr]=[AccID],1,0))) AS RestSum, Sum([j_qty]*(IIf([acc_db]=[AccID],1,0)-IIf([acc_cr]=[AccID],1,0))) AS RestQty, Sum([jf_qty]*(IIf([acc_db]=[AccID],1,0)-IIf([acc_cr]=[AccID],1,0))) AS RestFQty
	FROM JOURNAL RIGHT JOIN JRN_MISC ON JOURNAL.J_ID = JRN_MISC.J_ID
	WHERE (((JRN_MISC.MSC_ID)=[MscID]) AND ((JOURNAL.J_DONE)=2) AND ((JOURNAL.J_DATE)&lt;=[OnDate]) AND ((JOURNAL.MC_ID)=[MC]) AND ((([acc_db]=[AccID]) Or ([acc_cr]=[AccID] ))=True) AND ((JOURNAL.J_ENT)=[EntID])) and doc_id &lt;&gt; [DocID];
		</query>
		<query type="DAO" name="st7_TaxInDocs" cmd="del"/>
		<query type="DAO" name="st7_TaxInDocs" cmd="add" lastmodifieddate="6/27/2016 5:12:12 PM">PARAMETERS Acc631ID Long, StartDate DateTime, EndDate DateTime, MCID Long, TaxRepID Long;
	SELECT AG_REGNO, AG_NAME, J_DATE, DOC_NO, SUM(J_SUM)
	FROM ((JRN_TAX AS JT INNER JOIN JOURNAL AS J ON J.J_ID = JT.J_ID) INNER JOIN DOCUMENTS AS D ON D.DOC_ID = J.DOC_ID) INNER JOIN AGENTS AS A ON A.AG_ID = J.J_AG2
	WHERE JT.TX_ID = TaxRepID And JT_ADDR1 = 'Д.А.' And J.MC_ID = MCID And ACC_CR = Acc631ID And J_DATE &gt;= StartDate And J_DATE &lt; EndDate And  J_DONE = 2
	GROUP BY AG_REGNO, AG_NAME, J_DATE, DOC_NO;
		</query>
		<query type="DAO" name="st7_TaxInDocsB" cmd="del"/>
		<query type="DAO" name="st7_TaxInDocsB" cmd="add" lastmodifieddate="7/2/2016 8:24:47 PM">PARAMETERS Acc631ID Long, StartDate DateTime, EndDate DateTime, MCID Long, TaxRepID Long;
	SELECT AG_REGNO, AG_NAME, SUM(J_SUM)
	FROM (JRN_TAX AS JT INNER JOIN JOURNAL AS J ON J.J_ID = JT.J_ID) INNER JOIN AGENTS AS A ON A.AG_ID = J.J_AG2
	WHERE JT.TX_ID = TaxRepID And JT_ADDR1 = 'Д.Б.' And J.MC_ID = MCID And ACC_CR = Acc631ID And J_DATE &gt;= StartDate And J_DATE &lt; EndDate And  J_DONE = 2
	GROUP BY AG_REGNO, AG_NAME;
		</query>
		<query type="DAO" name="st7_TaxOutDocs" cmd="del"/>
		<query type="DAO" name="st7_TaxOutDocs" cmd="add" lastmodifieddate="6/27/2016 5:11:31 PM">PARAMETERS Acc361ID Long, StartDate DateTime, EndDate DateTime, MCID Long, TaxRepID Long;
	SELECT AG_REGNO, AG_NAME, J_DATE, DOC_NO, SUM(J_SUM)
	FROM ((JRN_TAX AS JT INNER JOIN JOURNAL AS J ON J.J_ID = JT.J_ID) INNER JOIN DOCUMENTS AS D ON D.DOC_ID = J.DOC_ID) INNER JOIN AGENTS AS A ON A.AG_ID = J.J_AG1
	WHERE JT.TX_ID = TaxRepID And JT_ADDR1 = 'Д.А.' And J.MC_ID = MCID And ACC_DB = Acc361ID And J_DATE &gt;= StartDate And J_DATE &lt; EndDate And  J_DONE = 2
	GROUP BY AG_REGNO, AG_NAME, J_DATE, DOC_NO;
		</query>
		<query type="DAO" name="ST74_AssetsGetRest" cmd="del"/>
		<query type="DAO" name="ST74_AssetsGetRest" cmd="add" lastmodifieddate="6/25/2016 9:11:30 PM">PARAMETERS AccID10 Long, AccID13 Long, OnDate DateTime, DocID Long, MCID Long;
	select JOURNAL.J_ENT, 
		JOURNAL.J_AG1 as AgID, 
		sum(JOURNAL.J_SUM), 
		sum(JOURNAL.J_SUM * -(JOURNAL.ACC_DB = AccID13)), 
		ENTITIES.ENT_NAME 
	from ENTITIES inner join JOURNAL on ENTITIES.ENT_ID = JOURNAL.J_ENT
	where JOURNAL.DOC_ID &lt;&gt; DocID and JOURNAL.MC_ID = MCID and JOURNAL.J_DONE = 2 and JOURNAL.J_DATE &lt; OnDate and (JOURNAL.ACC_DB = AccID13 or 
		JOURNAL.ACC_DB in (select id from acc_tree where p0 = AccID10 or p1 = AccID10 or p2 = AccID10 or p3 = AccID10 or p4 = AccID10 or p5 = AccID10 or p6 = AccID10 or p7 = AccID10 or id = AccID10))
	group by JOURNAL.J_ENT, JOURNAL.J_AG1, ENTITIES.ENT_NAME 

	UNION ALL select JOURNAL.J_ENT, 
		JOURNAL.J_AG2 AS AgID, 
		-sum(JOURNAL.J_SUM), 
		-sum(JOURNAL.J_SUM * -(JOURNAL.ACC_CR = AccID13)), 
	ENTITIES.ENT_NAME 
	from ENTITIES 
		inner join JOURNAL on ENTITIES.ENT_ID = JOURNAL.J_ENT 

	where JOURNAL.DOC_ID &lt;&gt; DocID and JOURNAL.MC_ID = MCID and JOURNAL.J_DONE = 2 and JOURNAL.J_DATE &lt; OnDate and (JOURNAL.ACC_CR = AccID13 or 
			JOURNAL.ACC_CR in (select id from acc_tree where p0 = AccID10 or p1 = AccID10 or p2 = AccID10 or p3 = AccID10 or p4 = AccID10 or p5 = AccID10 or p6 = AccID10 or p7 = AccID10 or id = AccID10)) 
	group by JOURNAL.J_ENT, JOURNAL.J_AG2, ENTITIES.ENT_NAME
	ORDER BY ENT_NAME, J_ENT, AgID;
		</query>
		<query type="DAO" name="ST74_AssetsGetRestEnt" cmd="del"/>
		<query type="DAO" name="ST74_AssetsGetRestEnt" cmd="add" lastmodifieddate="6/30/2016 11:42:37 AM">PARAMETERS EntID Long, AccID10 Long, AccID13 Long, OnDate DateTime, DocID Long, MCID Long;
	select JOURNAL.J_ENT, 
		JOURNAL.J_AG1 as AgID, 
		sum(JOURNAL.J_SUM), 
		sum(JOURNAL.J_SUM * -(JOURNAL.ACC_DB = AccID13)), 
		ENTITIES.ENT_NAME 
	from ENTITIES inner join JOURNAL on ENTITIES.ENT_ID = JOURNAL.J_ENT
	where j_ent = EntID and JOURNAL.DOC_ID &lt;&gt; DocID and JOURNAL.MC_ID = MCID and JOURNAL.J_DONE = 2 and JOURNAL.J_DATE &lt; OnDate and (JOURNAL.ACC_DB = AccID13 or 
		JOURNAL.ACC_DB in (select id from acc_tree where p0 = AccID10 or p1 = AccID10 or p2 = AccID10 or p3 = AccID10 or p4 = AccID10 or p5 = AccID10 or p6 = AccID10 or p7 = AccID10 or id = AccID10))
	group by JOURNAL.J_ENT, JOURNAL.J_AG1, ENTITIES.ENT_NAME 

	UNION ALL select JOURNAL.J_ENT, 
		JOURNAL.J_AG2 AS AgID, 
		-sum(JOURNAL.J_SUM), 
		-sum(JOURNAL.J_SUM * -(JOURNAL.ACC_CR = AccID13)), 
	ENTITIES.ENT_NAME 
	from ENTITIES 
		inner join JOURNAL on ENTITIES.ENT_ID = JOURNAL.J_ENT 

	where j_ent = EntID and  JOURNAL.DOC_ID &lt;&gt; DocID and JOURNAL.MC_ID = MCID and JOURNAL.J_DONE = 2 and JOURNAL.J_DATE &lt; OnDate and (JOURNAL.ACC_CR = AccID13 or 
			JOURNAL.ACC_CR in (select id from acc_tree where p0 = AccID10 or p1 = AccID10 or p2 = AccID10 or p3 = AccID10 or p4 = AccID10 or p5 = AccID10 or p6 = AccID10 or p7 = AccID10 or id = AccID10)) 
	group by JOURNAL.J_ENT, JOURNAL.J_AG2, ENTITIES.ENT_NAME
	ORDER BY ENT_NAME, J_ENT, AgID;
		</query>
	
		</scripts>
	</AccentWorkarea>
</AccentExportData>
